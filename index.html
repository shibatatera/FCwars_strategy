<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Êà¶Áï•„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ (GeminiÂà∂‰Ωú)</title>
    <style>
        body {
            margin: 0; padding: 0; overflow: hidden; background-color: #222;
            font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
            touch-action: none; -webkit-user-select: none; user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        canvas { display: block; margin: 0 auto; background-color: #000; }
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10;
        }
        .btn {
            pointer-events: auto; background: #fff; border: 2px solid #333; border-radius: 8px;
            padding: 12px 20px; font-weight: bold; font-size: 14px;
            box-shadow: 0 4px 0 #888; cursor: pointer; transition: transform 0.1s;
        }
        .btn:active { transform: translateY(4px); box-shadow: 0 0 0 #888; }
        #end-turn-btn {
            position: absolute; bottom: 20px; right: 20px;
            background-color: #ffecec; color: #d00; border-color: #d00; display: none;
        }
        #ingame-menu-btn {
            position: absolute; top: 10px; right: 10px; background-color: #eef; color: #338; padding: 8px 12px;
        }
        #info-panel {
            position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.95);
            padding: 8px 12px; border-radius: 6px; font-size: 13px; line-height: 1.4;
            pointer-events: none; display: none; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        #cargo-info-panel {
            display: none;
            position: absolute;
            top: 120px;
            left: 10px;
            background: rgba(0,0,0,0.75);
            border: 2px solid #fff;
            border-radius: 10px;
            padding: 5px;
            width: 74px;
            z-index: 20;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        #cargo-stats {
            color: white;
            font-size: 11px;
            text-align: center;
            margin-top: 2px;
            font-weight: bold;
        }
        #toast-msg {
            position: absolute; top: 15%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8); color: white; padding: 10px 20px; border-radius: 30px;
            font-size: 14px; pointer-events: none; opacity: 0; transition: opacity 0.3s;
            z-index: 300; text-align: center; width: max-content; max-width: 90%;
        }
        .overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100; display: none;
            flex-direction: column; justify-content: center; align-items: center;
            color: white; pointer-events: auto;
        }
        .menu-btn {
            background: #4a90e2; color: white; border: none; padding: 15px 0; margin: 10px;
            font-size: 16px; border-radius: 8px; cursor: pointer; width: 260px;
            text-align: center; box-shadow: 0 4px 0 #215a9c;
        }
        .menu-btn:active { transform: translateY(4px); box-shadow: none; }
        
        #action-menu {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 10px; pointer-events: auto; z-index: 50;
            display: none; flex-wrap: wrap; justify-content: center; width: 95%;
        }
        #stage-select {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
            max-height: 70vh; /* ÁîªÈù¢„ÅÆÈ´ò„Åï„ÅÆ70%„ÇíÊúÄÂ§ßÈ´ò„Åï„Å®„Åô„Çã */
            overflow-y: auto; /* Á∏¶ÊñπÂêë„Å´„Çπ„ÇØ„É≠„Éº„É´ÂèØËÉΩ„Å´„Åô„Çã */
            width: 100%; /* Ë¶™Ë¶ÅÁ¥†„ÅÆÂπÖ„ÅÑ„Å£„Å±„ÅÑ„Å´Â∫É„Åí„Çã */
            align-items: center; /* „Éú„Çø„É≥„Çí‰∏≠Â§ÆÂØÑ„Åõ */
            padding: 10px 0; /* ‰∏ä‰∏ã„ÅÆ„Éë„Éá„Ç£„É≥„Ç∞„ÇíËøΩÂä† */
            box-sizing: border-box; /* „Éë„Éá„Ç£„É≥„Ç∞„ÇíÂπÖ„Å´Âê´„ÇÅ„Çã */
        }
        .action-btn {
            background: #fff; border: 2px solid #333; border-radius: 10px;
            width: 60px; height: 60px; display: flex; justify-content: center; align-items: center;
            font-weight: bold; font-size: 11px; color: #333;
            box-shadow: 0 4px 0 rgba(0,0,0,0.5); cursor: pointer; flex-direction: column; margin-bottom: 5px;
        }
        .action-btn:active { transform: translateY(4px); box-shadow: none; }
        .action-btn.disabled { background: #ccc; color: #888; pointer-events: none; box-shadow: none; opacity: 0.7; display: none; }
        .action-icon { font-size: 18px; margin-bottom: 2px; }

        #targeting-ui, #drop-ui, #react-ui {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: none; pointer-events: auto; z-index: 55; flex-direction: column; align-items: center;
        }
        #confirm-attack-ui, #confirm-react-ui {
            position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%);
            display: none; pointer-events: auto; z-index: 60; flex-direction: column; align-items: center;
        }
        .fire-btn-group { display: flex; gap: 15px; }
        #fire-btn {
            background: #d00; color: white; border: 2px solid #fff;
            width: 100px; height: 50px; border-radius: 25px; font-size: 18px; font-weight: bold;
            box-shadow: 0 4px 0 #800; cursor: pointer;
        }
        #fire-btn:active { transform: translateY(4px); box-shadow: none; }
        #react-btn {
            background: #28a745; color: white; border: 2px solid #fff;
            width: 120px; height: 50px; border-radius: 25px; font-size: 18px; font-weight: bold;
            box-shadow: 0 4px 0 #1e7e34; cursor: pointer;
        }
        #react-btn:active { transform: translateY(4px); box-shadow: none; }

        .cancel-btn-small {
            background: #fff; color: #333; border: 2px solid #888; width: 80px; height: 50px;
            border-radius: 25px; font-size: 14px; font-weight: bold; box-shadow: 0 4px 0 #555; cursor: pointer;
        }
        .cancel-btn-small:active { transform: translateY(4px); box-shadow: none; }

        #production-menu {
            display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: #fff; color: #333; padding: 15px; border-radius: 12px; width: 320px;
            max-height: 85%; overflow-y: auto; z-index: 200;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); text-align: center; pointer-events: auto;
        }
        .prod-header { margin: 0 0 10px 0; padding-bottom: 10px; border-bottom: 1px solid #eee; font-size: 18px; font-weight: bold; }
        #unit-list { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 15px; }
        .unit-prod-btn {
            background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 10px;
            cursor: pointer; font-size: 12px; transition: background 0.1s;
            display: flex; flex-direction: column; align-items: center;
        }
        .unit-prod-btn:hover { background: #e2e6ea; }
        .unit-prod-btn b { font-size: 14px; margin-bottom: 4px; color:#000; }
        .unit-desc { font-size: 10px; color: #666; margin-top:2px;}
        .bg-cover {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.6); z-index: 199; display: none; pointer-events: auto;
        }
        
        #help-modal {
            background: white; color: #333; width: 90%; max-width: 400px; max-height: 80%;
            overflow-y: auto; border-radius: 10px; padding: 20px; box-sizing: border-box;
            display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            z-index: 200; box-shadow: 0 10px 30px rgba(0,0,0,0.5); pointer-events: auto;
        }
        #help-modal h3 { margin-top: 0; color: #4a90e2; border-bottom: 2px solid #eee; padding-bottom: 10px;}
        #help-modal ul { padding-left: 20px; font-size: 14px; }
        #help-modal li { margin-bottom: 8px; }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="ui-layer">
    <div id="info-panel"></div>
    <div id="toast-msg"></div>
    <button id="ingame-menu-btn" class="btn" onclick="toggleGameMenu()">„É°„Éã„É•„Éº</button>
    <button id="end-turn-btn" class="btn">„Çø„Éº„É≥ÁµÇ‰∫Ü</button>

    <div id="action-menu">
        <button id="act-attack" class="action-btn" onclick="game.uiActionAttack()"><span class="action-icon">‚öîÔ∏è</span>ÊîªÊíÉ</button>
        <button id="act-capture" class="action-btn" onclick="game.uiActionCapture()"><span class="action-icon">üè≥Ô∏è</span>Âç†È†ò</button>
        <button id="act-react" class="action-btn" onclick="game.uiActionReact()"><span class="action-icon">üîÑ</span>ÂÜçË°åÂãï</button>
        <button id="act-board" class="action-btn" onclick="game.uiActionBoard()"><span class="action-icon">üö™</span>Êê≠‰πó</button>
        <button id="act-drop" class="action-btn" onclick="game.uiActionDrop()"><span class="action-icon">üì¶</span>ÈôçËªä</button>
        <button id="act-wait" class="action-btn" onclick="game.uiActionWait()"><span class="action-icon">üõë</span>ÂæÖÊ©ü</button>
        <button id="act-cancel" class="action-btn" style="background:#eee;" onclick="game.uiActionCancel()"><span class="action-icon">‚Ü©Ô∏è</span>Êàª„Çã</button>
    </div>

    <div id="targeting-ui">
        <div style="color:white; margin-bottom:10px; font-weight:bold; text-shadow:1px 1px 0 #000;">ÊîªÊíÉÂØæË±°„ÇíÈÅ∏Êäû</div>
        <button class="cancel-btn-small" onclick="game.uiReturnToActionMenu()">Êàª„Çã</button>
    </div>
    <div id="react-ui">
        <div style="color:white; margin-bottom:10px; font-weight:bold; text-shadow:1px 1px 0 #000;">ÂÜçË°åÂãï„Åï„Åõ„ÇãÂë≥Êñπ„ÇíÈÅ∏Êäû</div>
        <button class="cancel-btn-small" onclick="game.uiReturnToActionMenu()">Êàª„Çã</button>
    </div>
    <div id="drop-ui">
        <div style="color:white; margin-bottom:10px; font-weight:bold; text-shadow:1px 1px 0 #000;">Èôç„Çç„ÅôÂ†¥ÊâÄ„ÇíÈÅ∏Êäû</div>
        <button class="cancel-btn-small" onclick="game.uiReturnToActionMenu()">Êàª„Çã</button>
    </div>

    <div id="confirm-attack-ui">
        <div class="fire-btn-group">
            <button class="cancel-btn-small" onclick="game.uiReturnToTargeting()">Êàª„Çã</button>
            <button id="fire-btn" onclick="game.uiConfirmAttack()">Áô∫Â∞ÑÔºÅ</button>
        </div>
        <div style="text-align:center; color:white; margin-top:5px; font-weight:bold; text-shadow:1px 1px 0 #000;">ÂØæË±°„Çí„Çø„ÉÉ„Éó„Åó„Å¶Â§âÊõ¥</div>
    </div>
    <div id="confirm-react-ui">
        <div class="fire-btn-group">
            <button class="cancel-btn-small" onclick="game.uiReturnToReact()">Êàª„Çã</button>
            <button id="react-btn" onclick="game.uiConfirmReact()">ÂÜçË°åÂãïÔºÅ</button>
        </div>
        <div style="text-align:center; color:white; margin-top:5px; font-weight:bold; text-shadow:1px 1px 0 #000;">ÂØæË±°„Çí„Çø„ÉÉ„Éó„Åó„Å¶Â§âÊõ¥</div>
    </div>

    <div id="cargo-info-panel" style="display: none;">
        <canvas id="cargo-canvas" width="60" height="60"></canvas>
        <div id="cargo-stats"></div>
    </div>
</div>

<div id="menu-overlay" class="overlay" style="display:flex;">
    <h1 style="margin-bottom:10px; text-shadow: 2px 2px 0 #000;">WAR SIMULATION</h1>
    <p style="font-size:14px; color:#ccc; margin-bottom:30px;">„Çπ„ÉÜ„Éº„Ç∏ 1 ~ 4 „ÅØ Gemini ‰ΩúÊàê ‰∏ä‰∏ã„Çπ„ÉØ„Ç§„Éó„ÅßÈÅ∏Êäû</p>
    <p style="font-size:14px; color:#ccc; margin-bottom:10px;">Á∑ë„ÅÆÊû†„Åå„Éï„Ç°„Éü„Ç≥„É≥„Ç¶„Ç©„Éº„Ç∫</p>
    <div id="stage-select">
        <button class="menu-btn" onclick="startGame(0)">„Çπ„ÉÜ„Éº„Ç∏ 1 (Âú∞‰∏äÊà¶)</button>
        <button class="menu-btn" onclick="startGame(1)">„Çπ„ÉÜ„Éº„Ç∏ 2 (Á©∫Ê∏ØËøΩÂä†)</button>
        <button class="menu-btn" onclick="startGame(2)">„Çπ„ÉÜ„Éº„Ç∏ 3 (Êµ∑Á©∫Êà¶)</button>
        <button class="menu-btn" style="background:#e67e22;" onclick="startGame(3)">„Çπ„ÉÜ„Éº„Ç∏ 4 (Â∑®Â§ß„Éû„ÉÉ„Éó)</button>

        <button class="menu-btn" style="background:#049628;" onclick="startGame(5)">„Çπ„ÉÜ„Éº„Ç∏ 5 („ÇΩ„É©„Éû„É°)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(6)">„Çπ„ÉÜ„Éº„Ç∏ 6 („Éâ„Éº„Éä„ÉÉ„ÉÑ)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(7)">„Çπ„ÉÜ„Éº„Ç∏ 7 („Åä„Å´„Åé„Çä)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(8)">„Çπ„ÉÜ„Éº„Ç∏ 8 („Çø„Éû„Çø„Éû)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(9)">„Çπ„ÉÜ„Éº„Ç∏ 9 („Éû„Ç¨„Çø„Éû)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(10)">„Çπ„ÉÜ„Éº„Ç∏ 10 („Éè„Ç¥„É≠„É¢)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(11)">„Çπ„ÉÜ„Éº„Ç∏ 11 („Ç≠„É°„É≥)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(12)">„Çπ„ÉÜ„Éº„Ç∏ 12 („Éö„Ç±)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(13)">„Çπ„ÉÜ„Éº„Ç∏ 13 („Ç¢„É©„É©)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(14)">„Çπ„ÉÜ„Éº„Ç∏ 14 („ÉÅ„É™„ÉÇ„É™)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(15)">„Çπ„ÉÜ„Éº„Ç∏ 15 („Éé„Ç¢„Ç´„Ç∂„É≥)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(16)">„Çπ„ÉÜ„Éº„Ç∏ 16 („ÉÑ„Ç≠„Éé„ÉØ)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(17)">„Çπ„ÉÜ„Éº„Ç∏ 17 („Éè„Éû„Ç≠)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(18)">„Çπ„ÉÜ„Éº„Ç∏ 18 („Çµ„Ç§„Ç≥„É≠)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(19)">„Çπ„ÉÜ„Éº„Ç∏ 19 („Éï„Çø„Ç¥)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(20)">„Çπ„ÉÜ„Éº„Ç∏ 20 („Éá„Éì„É©„Éº)</button>
        <button class="menu-btn" style="background:#049628;" onclick="startGame(21)">„Çπ„ÉÜ„Éº„Ç∏ 21 (ÊúÄÂæå„ÅÆÂ§¢)</button>

        <button class="menu-btn" style="background:#aa0854;" onclick="startGame(22)">„Çπ„ÉÜ„Éº„Ç∏ 22 („Éû„Éº„Çπ„Çø„Éì)</button>
        <button class="menu-btn" style="background:#aa0854;" onclick="startGame(23)">„Çπ„ÉÜ„Éº„Ç∏ 23 („Ç´„Ç≥„Çª„Ç§„Éè„É≥„Éà„Ç¶)</button>

        <button class="menu-btn" style="background:#d310c3;" onclick="startGame(24)">„Çπ„ÉÜ„Éº„Ç∏ 24 („Ç∏„É£„É≥„ÉúÂú∞‰∏ä)</button>
        <button class="menu-btn" style="background:#d310c3;" onclick="startGame(25)">„Çπ„ÉÜ„Éº„Ç∏ 25 („Ç∑„Éõ„Ç¶„Éè„ÉÉ„Éà„Ç¶)</button>
    </div>
</div>

<div id="message-overlay" class="overlay">
    <h2 id="message-text" style="font-size:2em; margin-bottom:20px;"></h2>
    <button class="menu-btn" onclick="resetGame()">„Çø„Ç§„Éà„É´„Å∏Êàª„Çã</button>
</div>

<div id="game-menu-bg" class="bg-cover" onclick="toggleGameMenu()" style="z-index: 149; display: none;"></div>
<div id="game-menu-modal" class="overlay" style="z-index: 150; display: none;">
    <h2 style="margin-bottom: 30px;">„É°„Éã„É•„Éº</h2>
    <div style="display: flex; flex-direction: column; gap: 10px; align-items: center;">
        <button class="menu-btn" onclick="showHelpFromMenu()">ÈÅä„Å≥Êñπ</button>
        <div style="width: 80%; text-align: center; margin: 15px 0; color: white;">
            <label for="speed-slider" style="display: block; margin-bottom: 5px;">„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÈÄüÂ∫¶</label>
            <input type="range" id="speed-slider" min="0.2" max="5" value="1.5" step="0.1" oninput="setAnimationSpeed(this.value)" style="width: 100%;">
        </div>
        <button id="anim-toggle-btn" class="menu-btn" onclick="toggleAnimation()">„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥: ON</button>
        <button class="menu-btn" style="background:#c0392b;" onclick="confirmReset()">„Ç≤„Éº„É†„É™„Çª„ÉÉ„Éà</button>
        <button class="menu-btn" style="background:#6c757d; margin-top: 20px;" onclick="toggleGameMenu()">Êàª„Çã</button>
    </div>
</div>

<div id="prod-bg" class="bg-cover" onclick="closeProduction()"></div>
<div id="production-menu">
    <div class="prod-header">„É¶„Éã„ÉÉ„ÉàÁîüÁî£</div>
    <div id="unit-list"></div>
    <button class="menu-btn" style="background:#6c757d; width:100%; margin:0; padding:12px;" onclick="closeProduction()">„Ç≠„É£„É≥„Çª„É´</button>
</div>

<div id="help-bg" class="bg-cover" onclick="toggleHelp()"></div>
<div id="help-modal">
    <h3>„Åã„ÅÇ„Å°„ÇÉ„Çì„Åü„Å°„Å´„ÅØ„Å™„ÅÑ„Åó„Çá„Å†„ÅûÔΩû</h3>
    <ul>
        <li><strong>„Ç≤„Éº„É†Á¥π‰ªã</strong></li>
        <p>„Éó„É¨„Ç§„É§„ÉºÔºàÈùíËªçÔºâ„Å®CPUÔºàËµ§ËªçÔºâ„ÅåÊà¶„ÅÜ„Çø„Éº„É≥Âà∂„ÅÆÊà¶Áï•„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Ç≤„Éº„É†„Åß„Åô„ÄÇ„É¶„Éã„ÉÉ„Éà„ÇíÁîüÁî£„ÉªÊåáÊèÆ„Åó„Å¶„ÄÅÊïµ„ÅÆÊú¨Êã†Âú∞„ÇíÂç†È†ò„Åï„Åõ„Çå„Å∞ÂãùÂà©„Åß„ÅôÔºÅ</p>
        <li><strong>Êìç‰ΩúÊñπÊ≥ï</strong></li>
        <p><strong>„É¶„Éã„ÉÉ„ÉàÈÅ∏Êäû:</strong> Ëá™ÂàÜ„ÅÆ„É¶„Éã„ÉÉ„Éà„Çí„Çø„ÉÉ„Éó„Åô„Çã„Å®ÁßªÂãïÁØÑÂõ≤„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô„ÄÇ</p>
        <p><strong>ÁßªÂãï:</strong> Ëâ≤„Åå„Å§„ÅÑ„ÅüÁØÑÂõ≤„Çí„Çø„ÉÉ„Éó„Åó„Å¶ÁßªÂãï„Åó„Åæ„Åô„ÄÇ</p>
        <p><strong>„É°„Éã„É•„Éº:</strong> ÁßªÂãïÂæå„ÄÅ„ÄåÊîªÊíÉ„Äç„ÄåÂæÖÊ©ü„Äç„ÄåÂç†È†ò„Äç„ÄåÊê≠‰πó„Äç„Å™„Å©„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„ÇíÈÅ∏„Å≥„Åæ„Åô„ÄÇ</p>
        <p><strong>„Éû„ÉÉ„ÉóÁßªÂãï:</strong> ÁîªÈù¢„Çí„Éâ„É©„ÉÉ„Ç∞„Åô„Çã„Å®„Éû„ÉÉ„Éó„ÇíË¶ãÊ∏°„Åõ„Åæ„Åô„ÄÇ„Éî„É≥„ÉÅ„Ç§„É≥„Éª„Éî„É≥„ÉÅ„Ç¢„Ç¶„Éà„Åß„Ç∫„Éº„É†„Éª„Ç∫„Éº„É†„Ç¢„Ç¶„Éà„Åß„Åç„Åæ„Åô„ÄÇ</p>
        <p>PC„Å™„ÇâÂ∑¶„ÇØ„É™„ÉÉ„ÇØÈï∑Êäº„Åó„ÅßË¶ãÊ∏°„Åõ„ÄÅ„Éû„Ç¶„Çπ„Éõ„Ç§„Éº„É´ÂõûËª¢„Åß„Ç∫„Éº„É†„Åß„Åô„ÄÇ</p>
        <p><strong>ÁîüÁî£:</strong> „Ç™„É¨„É≥„Ç∏Ëâ≤„ÅÆÊû†„ÅÆ„ÅÇ„ÇãËá™ÂàÜ„ÅÆÊã†ÁÇπÔºàË°ó„ÇÑÁ©∫Ê∏Ø„Å™„Å©Ôºâ„Åß„ÄÅ„É¶„Éã„ÉÉ„Éà„Åå‰πó„Å£„Å¶„ÅÑ„Å™„ÅÑÁä∂ÊÖã„ÅÆÊôÇ„Å´„Çø„ÉÉ„Éó„Åô„Çã„Å®„ÄÅË≥áÈáë„Çí‰Ωø„Å£„Å¶„É¶„Éã„ÉÉ„Éà„ÇíÁîüÁî£„Åß„Åç„Åæ„Åô„ÄÇ</p>
        <li><strong>ÂãùÂà©Êù°‰ª∂</strong></li>
        <p><strong>ÊïµÊú¨Êã†Âú∞„ÅÆÂç†È†ò:</strong> Êïµ„ÅÆÊú¨Êã†Âú∞Ôºà‚òÖ„Éû„Éº„ÇØ„ÅÆÂª∫Áâ©Ôºâ„Å´Ê≠©ÂÖµ„ÇíÈÄÅ„ÇäËæº„Åø„ÄÅÂç†È†ò„ÇíÂÆå‰∫Ü„Åô„Çã„ÄÇ</p>
        <li><strong>„É¶„Éã„ÉÉ„Éà</strong></li>
        <p>„É¶„Éã„ÉÉ„Éà„Å´„ÅØÂêÑÁõ∏ÊÄß„Åå„ÅÇ„Çä„ÄÅ‰ΩìÂäõ„ÄÅÊÆãÂºæÊï∞„ÄÅÊê≠‰πó„Åó„Å¶„ÅÑ„Çã„Åã„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô„ÄÇ</p>
        <p>„É¶„Éã„ÉÉ„Éà‰∏ãÂÅ¥„ÅÆ„Ç≤„Éº„Ç∏„ÅØ‰ΩìÂäõ„ÇíÁ§∫„Åó„Åæ„Åô„ÄÇ</p>
        <p>ÊÆãÂºæÊï∞„ÅØ„É¶„Éã„ÉÉ„ÉàÂ∑¶‰∏ä„ÅÆÊï∞Â≠ó„ÅßË°®Á§∫„Åï„Çå„ÄÅ„Å™„Åè„Å™„Çã„Å®ÊîªÊíÉ„Åß„Åç„Å™„Åè„Å™„Çä„Åæ„Åô„ÄÇ‰ΩìÂäõ„ÇÑÊÆãÂºæÊï∞„ÅØÂØæÂøú„Åô„ÇãÂª∫Áâ©„ÇÑË£úÁµ¶ËªäÔºàÂºæ„ÅÆ„ÅøÔºâ„ÅßË£úÂÖÖ„Åß„Åç„Åæ„Åô„ÄÇ</p>
        <li><strong>Âú∞ÂΩ¢</strong></li>
        <p>Ê£Æ„ÇÑÂ±±„Å™„Å©„ÅØÁßªÂãï„Ç≥„Çπ„Éà„ÅåÈ´ò„ÅÑ„Åß„Åô„ÄÇ</p>
        <p>„É¶„Éã„ÉÉ„Éà„Å´ÂØæÂøú„Åô„ÇãÂª∫Áâ©„Å´ÂæÖÊ©ü„Åï„Åõ„Çã„Å®„ÄÅÊ¨°„ÅÆ„Çø„Éº„É≥„Åß‰ΩìÂäõ„Å®ÊÆãÂºæÊï∞„ÇíÂõûÂæ©„Åó„Åæ„Åô„ÄÇ</p>
        <p>Ê£Æ„ÄÅÂ±±„ÄÅÂª∫Áâ©„Å´„ÅÑ„Çã„Å®Èò≤Âæ°Âäõ„Åå„ÅÇ„Åå„Çä„Åæ„Åô„ÄÇ</p>
        <li>„Åù„ÅÆ‰ªñ</li>
        <p>CPU„ÅÆÂá∫Êù•Ê†Ñ„Åà„Å´„ÅØÊúüÂæÖ„Åó„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ„Åî„ÇÅ„Çì„Å™„Åï„ÅÑ„ÄÇ</p>
        <p>Gemini „Å® Gemini CLI „Å´Ê©üËÉΩ„ÅÆÂÖ®„Å¶„Çí‰Ωú„Å£„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åó„Åü„ÄÇ„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</p>
    </ul>
    <button class="menu-btn" style="width:100%; margin:10px 0 0 0; padding:10px;" onclick="toggleHelp()">Èñâ„Åò„Çã</button>
</div>

<script>
const BASE_TILE_SIZE = 50;
let isAnimationEnabled = true;
let animationSpeed = 1.5;

let COLS = 10;
let ROWS = 12; 

const TERRAIN = {
    PLAIN: 0, ROAD: 1, FOREST: 2, MOUNTAIN: 3, SEA: 4,
    HQ: 10, CITY: 11, PORT: 12, AIRPORT: 13, SHOAL: 14,
    RIVER: 15, POND: 16
};
const BUILDING_IDS = [10, 11, 12, 13];

const TERRAIN_PROPS = {
    [TERRAIN.PLAIN]: { color: '#34921d', cost: 1, defense: 1 },
    [TERRAIN.ROAD]:  { color: '#aaa', cost: 1, defense: 0 }, 
    [TERRAIN.FOREST]:{ color: '#272', cost: 2, defense: 2 },
    [TERRAIN.MOUNTAIN]:{ color: '#642', cost: 99, defense: 4 }, 
    [TERRAIN.SEA]:   { color: '#48d', cost: 1, defense: 0 },    
    [TERRAIN.HQ]:    { color: '#333', cost: 1, defense: 3 },
    [TERRAIN.CITY]:  { color: '#bbb', cost: 1, defense: 3 },
    [TERRAIN.PORT]:  { color: '#48d', cost: 1, defense: 2 },     
    [TERRAIN.AIRPORT]:{ color: '#999', cost: 1, defense: 2 },
    [TERRAIN.SHOAL]: { color: '#b8860b', cost: 1, defense: 0 },
    [TERRAIN.RIVER]: { color: '#add8e6', cost: 5, defense: 0 },
    [TERRAIN.POND]:  { color: '#00008b', cost: 99, defense: 0 }
};

const UNIT_TYPES = {
    INFANTRY: 'infantry', APC: 'apc', TANK: 'tank', ARTILLERY: 'artillery', ANTIAIR: 'antiair', SUPPLY: 'supply',
    HELI: 'heli', FIGHTER: 'fighter', BOMBER: 'bomber', SHIP: 'ship', CARRIER: 'carrier', LANDER: 'lander'
};
const MOVETYPE = { LAND: 0, AIR: 1, SEA: 2, FOOT: 3 };

const DMG = {
    [UNIT_TYPES.INFANTRY]: { [UNIT_TYPES.INFANTRY]: 55, [UNIT_TYPES.APC]: 15, [UNIT_TYPES.TANK]: 5,  [UNIT_TYPES.ARTILLERY]: 15, [UNIT_TYPES.ANTIAIR]: 15, [UNIT_TYPES.SUPPLY]: 15, [UNIT_TYPES.HELI]: 15, [UNIT_TYPES.BOMBER]: 10, [UNIT_TYPES.FIGHTER]: 10, [UNIT_TYPES.LANDER]: 10 },
    [UNIT_TYPES.APC]:      { [UNIT_TYPES.INFANTRY]: 75, [UNIT_TYPES.APC]: 50, [UNIT_TYPES.TANK]: 15, [UNIT_TYPES.ARTILLERY]: 50, [UNIT_TYPES.ANTIAIR]: 50, [UNIT_TYPES.SUPPLY]: 60, [UNIT_TYPES.HELI]: 40, [UNIT_TYPES.BOMBER]: 0, [UNIT_TYPES.FIGHTER]: 0, [UNIT_TYPES.LANDER]: 20 },
    [UNIT_TYPES.TANK]:     { [UNIT_TYPES.INFANTRY]: 80, [UNIT_TYPES.APC]: 85, [UNIT_TYPES.TANK]: 55, [UNIT_TYPES.ARTILLERY]: 75, [UNIT_TYPES.ANTIAIR]: 75, [UNIT_TYPES.SUPPLY]: 90, [UNIT_TYPES.HELI]: 15, [UNIT_TYPES.BOMBER]: 0, [UNIT_TYPES.FIGHTER]: 0, [UNIT_TYPES.SHIP]: 10, [UNIT_TYPES.LANDER]: 55 },
    [UNIT_TYPES.ARTILLERY]:{ [UNIT_TYPES.INFANTRY]: 40, [UNIT_TYPES.APC]: 70, [UNIT_TYPES.TANK]: 70, [UNIT_TYPES.ARTILLERY]: 75, [UNIT_TYPES.ANTIAIR]: 75, [UNIT_TYPES.SUPPLY]: 80, [UNIT_TYPES.HELI]: 0, [UNIT_TYPES.BOMBER]: 0, [UNIT_TYPES.FIGHTER]: 0, [UNIT_TYPES.SHIP]: 40, [UNIT_TYPES.LANDER]: 60 },
    [UNIT_TYPES.ANTIAIR]:  { [UNIT_TYPES.INFANTRY]: 0, [UNIT_TYPES.APC]: 0, [UNIT_TYPES.TANK]: 0, [UNIT_TYPES.ARTILLERY]: 0, [UNIT_TYPES.ANTIAIR]: 0, [UNIT_TYPES.SUPPLY]: 0, [UNIT_TYPES.HELI]: 95, [UNIT_TYPES.BOMBER]: 85, [UNIT_TYPES.FIGHTER]: 75, [UNIT_TYPES.SHIP]: 0, [UNIT_TYPES.LANDER]: 0 },
    [UNIT_TYPES.SUPPLY]:   { [UNIT_TYPES.INFANTRY]: 0, [UNIT_TYPES.APC]: 0, [UNIT_TYPES.TANK]: 0, [UNIT_TYPES.ARTILLERY]: 0, [UNIT_TYPES.ANTIAIR]: 0, [UNIT_TYPES.SUPPLY]: 0, [UNIT_TYPES.HELI]: 0, [UNIT_TYPES.BOMBER]: 0, [UNIT_TYPES.FIGHTER]: 0, [UNIT_TYPES.SHIP]: 0, [UNIT_TYPES.LANDER]: 0 },
    [UNIT_TYPES.HELI]:     { [UNIT_TYPES.INFANTRY]: 60, [UNIT_TYPES.APC]: 60, [UNIT_TYPES.TANK]: 30, [UNIT_TYPES.ARTILLERY]: 60, [UNIT_TYPES.ANTIAIR]: 35, [UNIT_TYPES.SUPPLY]: 60, [UNIT_TYPES.HELI]: 60, [UNIT_TYPES.BOMBER]: 15, [UNIT_TYPES.FIGHTER]: 15, [UNIT_TYPES.SHIP]: 20, [UNIT_TYPES.LANDER]: 40 },
    [UNIT_TYPES.FIGHTER]:  { [UNIT_TYPES.INFANTRY]: 65, [UNIT_TYPES.APC]: 50, [UNIT_TYPES.TANK]: 25, [UNIT_TYPES.ARTILLERY]: 30, [UNIT_TYPES.ANTIAIR]: 30, [UNIT_TYPES.SUPPLY]: 30, [UNIT_TYPES.HELI]: 100, [UNIT_TYPES.BOMBER]: 100, [UNIT_TYPES.FIGHTER]: 55, [UNIT_TYPES.SHIP]: 20, [UNIT_TYPES.LANDER]: 40 },
    [UNIT_TYPES.BOMBER]:   { [UNIT_TYPES.INFANTRY]: 85, [UNIT_TYPES.APC]: 110, [UNIT_TYPES.TANK]: 105, [UNIT_TYPES.ARTILLERY]: 110, [UNIT_TYPES.ANTIAIR]: 105, [UNIT_TYPES.SUPPLY]: 110, [UNIT_TYPES.HELI]: 0, [UNIT_TYPES.BOMBER]: 0, [UNIT_TYPES.FIGHTER]: 0, [UNIT_TYPES.SHIP]: 85, [UNIT_TYPES.CARRIER]: 105, [UNIT_TYPES.LANDER]: 105 },
    [UNIT_TYPES.SHIP]:     { [UNIT_TYPES.INFANTRY]: 55, [UNIT_TYPES.APC]: 80, [UNIT_TYPES.TANK]: 80, [UNIT_TYPES.ARTILLERY]: 80, [UNIT_TYPES.ANTIAIR]: 80, [UNIT_TYPES.SUPPLY]: 85, [UNIT_TYPES.HELI]: 85, [UNIT_TYPES.BOMBER]: 85, [UNIT_TYPES.FIGHTER]: 85, [UNIT_TYPES.SHIP]: 55, [UNIT_TYPES.CARRIER]: 60, [UNIT_TYPES.LANDER]: 95 },
    [UNIT_TYPES.CARRIER]:  { [UNIT_TYPES.INFANTRY]: 0, [UNIT_TYPES.APC]: 0, [UNIT_TYPES.TANK]: 0, [UNIT_TYPES.ARTILLERY]: 0, [UNIT_TYPES.ANTIAIR]: 0, [UNIT_TYPES.SUPPLY]: 0, [UNIT_TYPES.HELI]: 100, [UNIT_TYPES.BOMBER]: 100, [UNIT_TYPES.FIGHTER]: 80, [UNIT_TYPES.SHIP]: 0, [UNIT_TYPES.LANDER]: 0 },
    [UNIT_TYPES.LANDER]:   { [UNIT_TYPES.INFANTRY]: 0, [UNIT_TYPES.APC]: 0, [UNIT_TYPES.TANK]: 0, [UNIT_TYPES.ARTILLERY]: 0, [UNIT_TYPES.ANTIAIR]: 0, [UNIT_TYPES.SUPPLY]: 0, [UNIT_TYPES.HELI]: 0, [UNIT_TYPES.BOMBER]: 0, [UNIT_TYPES.FIGHTER]: 0, [UNIT_TYPES.SHIP]: 0, [UNIT_TYPES.LANDER]: 0 }
};

const UNITS = {
    [UNIT_TYPES.INFANTRY]: { name: 'ÂÖµÂ£´', label: 'Ê≠©', cost: 1000, move: 3, range: [1,1], moveType: MOVETYPE.FOOT, desc: 'ÈÉΩÂ∏ÇÂç†È†ò', maxAmmo: 10 },
    [UNIT_TYPES.APC]:      { name: 'Ë£ÖÁî≤Ëªä', label: 'Ë£Ö', cost: 4000, move: 6, range: [1,1], moveType: MOVETYPE.LAND, desc: 'ÂÖµÂ£´Ëº∏ÈÄÅ', capacityType: [MOVETYPE.FOOT], maxAmmo: 6 },
    [UNIT_TYPES.TANK]:     { name: 'Êà¶Ëªä', label: 'Êà¶', cost: 14000, move: 5, range: [1,1], moveType: MOVETYPE.LAND, desc: '‰∏ªÂäõÊà¶Âäõ', maxAmmo: 5 },
    [UNIT_TYPES.ARTILLERY]:{ name: 'Ëá™Ëµ∞Á†≤', label: 'Á†≤', cost: 11000, move: 4, range: [2,5], moveType: MOVETYPE.LAND, desc: 'Â∞ÑÁ®ã2~5(ÁßªÂãïÊôÇÊîªÊíÉ‰∏çÂèØ)', maxAmmo: 4 },
    [UNIT_TYPES.ANTIAIR]:  { name: 'ÂØæÁ©∫Á†≤', label: 'Á©∫', cost: 4400, move: 5, range: [1,2], moveType: MOVETYPE.LAND, desc: 'ÂØæÁ©∫„ÅÆ„Åø„ÉªÂ∞ÑÁ®ã1~2', maxAmmo: 5 },
    [UNIT_TYPES.SUPPLY]:   { name: 'Ë£úÁµ¶Ëªä', label: 'Ë£ú', cost: 7000, move: 5, range: [0,0], moveType: MOVETYPE.LAND, desc: 'ÂÜçË°åÂãï„ÉªÈö£„ÅÆÂºæËñ¨Ë£úÁµ¶', maxAmmo: 1 },
    [UNIT_TYPES.HELI]:     { name: '„Éò„É™', label: '„Éò', cost: 5300, move: 6, range: [1,1], moveType: MOVETYPE.AIR, desc: 'ÂÖµÂ£´Ëº∏ÈÄÅ', capacityType: [MOVETYPE.FOOT], maxAmmo: 5 },
    [UNIT_TYPES.FIGHTER]:  { name: 'Êà¶ÈóòÊ©ü', label: 'Èóò', cost: 20000, move: 10, range: [1,1], moveType: MOVETYPE.AIR, desc: 'Á©∫ÁâπÊîª„ÉªÂú∞‰∏ä„ÇÇÊîªÊíÉ', maxAmmo: 5 },
    [UNIT_TYPES.BOMBER]:   { name: 'ÁàÜÊíÉÊ©ü', label: 'ÁàÜ', cost: 22000, move: 8, range: [1,1], moveType: MOVETYPE.AIR, desc: 'ÂØæÂú∞ÊúÄÂº∑', maxAmmo: 4 },
    [UNIT_TYPES.SHIP]:     { name: 'Êà¶Ëâ¶', label: 'Ëâ¶', cost: 28000, move: 5, range: [2,5], moveType: MOVETYPE.SEA, desc: 'Â∞ÑÁ®ã2~5‰∏áËÉΩ', maxAmmo: 5 },
    [UNIT_TYPES.CARRIER]:  { name: 'Á©∫ÊØç', label: 'ÊØç', cost: 30000, move: 5, range: [1,1], moveType: MOVETYPE.SEA, desc: 'ÂØæÁ©∫', maxAmmo: 5 },
    [UNIT_TYPES.LANDER]:   { name: 'Ëº∏ÈÄÅËàπ', label: 'Ëº∏', cost: 12000, move: 6, range: [0,0], moveType: MOVETYPE.SEA, desc: 'Ëº∏ÈÄÅ', capacityType: [MOVETYPE.LAND, MOVETYPE.FOOT, MOVETYPE.ARTILLERY, MOVETYPE.ANTIAIR, MOVETYPE.SUPPLY], maxAmmo: 0 }
};

const STAGES = [
    // Stage 1
    [
        [ 2, 2, 3, 3, 10, 1, 3, 3, 2, 2],
        [ 2, 11, 0, 0, 1, 1, 0, 0, 11, 2],
        [ 3, 0, 13, 0, 1, 1, 0, 13, 0, 3],
        [ 3, 0, 0, 0, 1, 1, 0, 0, 0, 3],
        [ 11, 1, 1, 1, 1, 1, 1, 1, 1, 11],
        [ 1, 1, 2, 2, 0, 0, 2, 2, 1, 1],
        [ 1, 1, 2, 2, 0, 0, 2, 2, 1, 1],
        [ 11, 1, 1, 1, 1, 1, 1, 1, 1, 11],
        [ 3, 0, 0, 0, 1, 1, 0, 0, 0, 3],
        [ 3, 0, 13, 0, 1, 1, 0, 13, 0, 3], 
        [ 2, 11, 0, 0, 1, 1, 0, 0, 11, 2],
        [ 2, 2, 3, 3, 10, 1, 3, 3, 2, 2],
    ],
    // Stage 2
    [
        [ 3, 3, 3, 3, 10, 13, 3, 3, 3, 3],
        [ 3, 11, 0, 2, 1, 1, 2, 0, 11, 3],
        [ 3, 0, 2, 2, 1, 1, 2, 2, 0, 3],
        [ 3, 2, 3, 3, 1, 1, 3, 3, 2, 3],
        [ 14, 4, 4, 1, 1, 1, 1, 4, 4, 14],
        [ 14, 12, 4, 1, 1, 1, 1, 4, 12, 14],
        [ 14, 12, 4, 1, 1, 1, 1, 4, 12, 14],
        [ 14, 4, 4, 1, 1, 1, 1, 4, 4, 14],
        [ 3, 2, 3, 3, 1, 1, 3, 3, 2, 3],
        [ 3, 0, 2, 2, 1, 1, 2, 2, 0, 3],
        [ 3, 11, 0, 2, 1, 1, 2, 0, 11, 3],
        [ 3, 3, 3, 3, 13, 10, 3, 3, 3, 3],
    ],
    // Stage 3
    [
        [ 4, 4, 4, 4, 10, 4, 4, 4, 4, 4],
        [ 4, 12, 0, 13, 11, 11, 13, 0, 12, 4],
        [ 4, 0, 0, 0, 3, 3, 0, 0, 0, 4],
        [ 4, 4, 0, 0, 3, 3, 0, 0, 4, 4],
        [ 14, 4, 4, 4, 4, 4, 4, 4, 4, 14],
        [ 14, 4, 11, 4, 11, 11, 4, 11, 4, 14],
        [ 14, 4, 11, 4, 11, 11, 4, 11, 4, 14],
        [ 14, 4, 4, 4, 4, 4, 4, 4, 4, 14],
        [ 4, 4, 0, 0, 3, 3, 0, 0, 4, 4],
        [ 4, 0, 0, 0, 3, 3, 0, 0, 0, 4],
        [ 4, 12, 0, 13, 11, 11, 13, 0, 12, 4],
        [ 4, 4, 4, 4, 10, 4, 4, 4, 4, 4],
    ],
    // Stage 4
    [
        [ 4, 4, 4, 4, 4, 4, 4, 4, 12, 10, 11, 13, 4, 4, 4, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 4, 4, 12, 0, 0, 0, 0, 12, 4, 4, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 4, 0, 0, 2, 2, 3, 3, 0, 0, 4, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 0, 0, 11, 3, 3, 3, 3, 11, 0, 0, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 0, 0, 2, 2, 3, 3, 3, 3, 2, 2, 0, 0, 4, 4, 4, 4],
        [ 4, 4, 4, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, 4],
        [ 4, 4, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 4, 4],
        [ 4, 4, 0, 13, 0, 1, 0, 11, 0, 0, 0, 0, 11, 0, 1, 0, 13, 0, 4, 4],
        [ 4, 12, 0, 0, 0, 1, 0, 0, 3, 3, 3, 3, 0, 0, 1, 0, 0, 0, 12, 4],
        [ 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4],
        [ 4, 12, 0, 0, 0, 1, 0, 0, 3, 3, 3, 3, 0, 0, 1, 0, 0, 0, 12, 4],
        [ 4, 4, 0, 13, 0, 1, 0, 11, 0, 0, 0, 0, 11, 0, 1, 0, 13, 0, 4, 4],
        [ 4, 4, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 4, 4],
        [ 4, 4, 4, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 0, 0, 2, 2, 3, 3, 3, 3, 2, 2, 0, 0, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 0, 0, 11, 3, 3, 3, 3, 11, 0, 0, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 4, 0, 0, 2, 2, 3, 3, 0, 0, 4, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 4, 4, 12, 0, 0, 0, 0, 12, 4, 4, 4, 4, 4, 4, 4],
        [ 4, 4, 4, 4, 4, 4, 4, 4, 12, 10, 11, 13, 4, 4, 4, 4, 4, 4, 4, 4],
    ],
    // Stage 5-a „Éá„Éê„ÉÉ„Ç∞
    [
        [ 10, 0, 0, 0, 10, 12, 4, 0, 0, 10],
        [ 0, 2, 0, 0, 0, 0, 4, 0, 2, 0],
        [ 0, 0, 2, 0, 2, 0, 4, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 4, 0, 0, 0],
        [ 14, 0, 0, 0, 0, 0, 4, 0, 0, 0],
        [ 4, 4, 0, 0, 0, 0, 4, 14, 0, 0],
        [ 4, 4, 4, 4, 4, 14, 4, 4, 4, 4],
        [ 4, 4, 0, 0, 0, 0, 4, 0, 4, 0],
        [ 14, 0, 0, 0, 0, 0, 4, 0, 4, 0],
        [ 0, 0, 1, 0, 1, 11, 4, 0, 4, 0],
        [ 0, 1, 0, 0, 0, 0, 4, 0, 4, 0],
        [ 0, 0, 0, 0, 10, 0, 14, 0, 14, 10],
    ],
    // Stage 5 „ÇΩ„É©„Éû„É°
    //PLAIN: 0, ROAD: 1, FOREST: 2, MOUNTAIN: 3, SEA: 4,
    //HQ: 10, CITY: 11, PORT: 12, AIRPORT: 13, RIVER: 15, POND: 16
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,0,0,4,4,0,3,4,4,4,4],
        [4,4,0,0,3,2,2,2,2,2,2,3,3,0,4,4],
        [4,0,0,3,3,0,0,0,0,0,0,3,3,0,0,4],
        [4,11,11,3,3,11,11,11,11,11,11,3,3,11,11,4],
        [4,0,0,0,3,1,1,1,1,1,1,3,0,0,0,4],
        [4,11,0,11,3,1,0,3,3,0,1,3,11,0,11,4],
        [4,10,11,1,3,1,11,3,3,11,1,3,1,11,10,4],
        [4,11,2,1,3,1,0,3,3,0,1,3,1,2,11,4],
        [4,0,0,1,1,1,11,3,3,11,1,1,1,0,0,4],
        [4,11,11,0,2,2,3,3,3,3,2,2,2,11,11,4],
        [4,4,4,0,0,0,0,0,4,0,0,0,3,0,4,4],
        [4,4,4,4,0,0,4,4,4,4,4,0,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 6 „Éâ„Éº„Éä„ÉÉ„ÉÑ
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,0,0,0,0,0,0,4,4,4,4],
        [4,4,4,4,11,10,11,1,11,11,11,11,0,0,4,4],
        [4,4,0,0,1,11,0,0,0,0,0,2,2,2,2,4],
        [4,0,11,11,1,0,0,0,11,11,2,2,2,2,0,4],
        [4,0,0,1,1,11,0,4,0,2,2,2,2,2,11,4],
        [4,0,0,1,0,0,4,4,0,4,4,0,2,2,2,4],
        [4,0,0,1,3,4,4,4,4,4,4,11,2,2,0,4],
        [4,0,1,1,0,4,4,4,4,4,4,2,2,2,11,4],
        [4,11,1,0,11,4,4,0,0,4,0,2,2,2,2,4],
        [4,0,1,3,0,0,0,11,0,0,0,0,0,0,0,4],
        [4,11,1,1,1,3,0,0,11,0,0,11,0,11,11,4],
        [4,4,0,0,1,1,1,0,0,11,0,11,0,0,4,4],
        [4,4,4,11,0,0,1,1,11,0,11,10,11,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 7 „Åä„Å´„Åé„Çä
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,2,2,0,0,4,0,11,0,4,4],
        [4,4,4,4,4,0,0,0,11,11,0,13,10,13,0,4],
        [4,4,0,4,4,4,11,0,2,2,0,0,11,0,0,4],
        [4,4,11,0,4,4,4,0,0,0,11,2,2,2,2,4],
        [4,0,0,0,0,4,4,4,11,0,2,2,0,0,4,4],
        [4,11,0,11,0,0,4,4,4,11,0,0,11,11,0,4],
        [4,4,0,2,2,11,0,4,4,4,0,0,2,2,0,4],
        [4,0,11,0,2,2,2,0,4,4,4,11,2,2,11,4],
        [4,0,0,0,0,0,0,11,0,4,4,4,0,0,0,4],
        [4,11,0,0,11,11,3,0,0,0,4,4,4,11,0,4],
        [4,0,0,11,0,0,2,2,2,0,4,4,4,0,4,4,],
        [4,4,13,10,13,0,2,2,0,11,0,4,4,4,4,4],
        [4,4,0,11,0,0,2,2,11,0,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 8 „Çø„Éû„Çø„Éû
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,0,14,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,11,11,14,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,14,14,14,14,14,4,4,4,4,4,4,4,4,4,4,4,14,14,4,4,14,14,4,4,4,4,14,14,14,14,14,4,4,14,14,4,4,4],
        [4,4,14,14,0,0,0,0,0,14,14,14,4,4,4,4,4,4,4,14,0,0,14,4,4,4,4,4,14,14,0,0,0,0,0,14,14,0,0,14,4,4],
        [4,14,0,0,2,2,2,2,2,0,0,0,14,4,4,4,4,4,4,14,0,13,0,14,4,4,4,14,0,0,0,11,2,2,0,0,0,11,0,14,4,4],
        [4,4,12,0,11,0,11,0,0,0,2,2,0,14,14,4,4,4,4,14,11,0,11,14,4,4,14,0,11,0,2,0,0,0,11,2,2,2,0,0,14,4],
        [4,14,0,11,10,11,0,3,0,11,0,2,0,0,0,14,4,4,4,14,0,11,0,14,4,4,14,0,0,2,0,3,0,11,0,3,11,2,0,12,4,4],
        [4,4,12,0,11,0,0,3,0,0,3,0,11,2,11,0,14,4,4,4,14,14,0,14,4,4,14,0,0,2,0,0,0,0,0,3,0,11,13,0,14,4],
        [4,14,0,13,0,13,0,0,0,0,3,0,0,0,0,0,0,14,4,4,4,4,14,4,4,4,14,0,0,2,0,0,3,0,0,11,3,10,11,0,14,4],
        [4,14,0,2,0,0,0,3,0,0,0,0,3,0,2,11,0,0,14,4,4,4,4,4,4,4,4,14,0,0,2,0,3,0,0,3,0,11,0,12,4,4],
        [4,14,0,3,2,2,0,2,2,11,0,2,2,11,0,0,11,0,14,4,4,4,4,4,4,4,4,4,14,0,0,2,0,11,0,0,0,2,13,0,14,4],
        [4,4,14,0,0,0,11,0,0,0,11,0,0,0,0,0,0,14,4,4,4,4,14,14,4,4,4,4,4,14,0,0,2,2,2,0,11,2,0,14,4,4],
        [4,4,4,14,0,0,0,14,14,14,0,0,0,12,14,14,14,4,4,4,4,14,0,0,14,14,4,4,4,4,14,14,0,0,0,11,0,0,14,4,4,4],
        [4,4,4,4,14,14,14,4,4,4,14,14,14,4,4,4,4,4,4,4,14,0,11,0,0,0,14,4,4,4,4,4,14,14,14,14,14,14,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,11,0,11,11,13,0,14,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 9 „Éû„Ç¨„Çø„Éû
    [
        [4,4,4,4,4,4,4,4,3,3,3,4,4,4,4,4],
        [4,4,4,4,4,0,0,0,0,0,0,0,4,4,4,4],
        [4,4,4,1,1,11,11,11,11,11,11,11,1,0,4,4],
        [4,4,1,1,0,0,1,1,1,3,3,3,1,11,0,4],
        [4,1,1,0,3,3,0,0,1,0,3,3,3,1,0,4],
        [4,1,0,3,3,3,0,11,1,1,0,3,3,1,11,4],
        [4,1,1,3,0,3,3,3,4,1,11,1,1,1,2,4],
        [4,4,1,1,1,0,2,4,4,4,2,2,1,2,2,4],
        [4,4,4,2,1,11,4,4,4,4,4,2,1,1,4,4],
        [4,4,2,2,1,2,2,4,4,4,2,2,0,1,2,4],
        [4,2,2,2,1,0,2,2,4,2,2,0,11,1,2,4],
        [4,2,2,11,1,0,0,2,4,2,0,11,10,11,4,4],
        [4,4,11,10,11,0,0,4,4,4,0,0,11,0,4,4],
        [4,4,4,11,0,0,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 10 „Éè„Ç¥„É≠„É¢
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,0,0,0,0,4,4,14,0,0,0,0,0,0,0,4,4,0,0,0,0,14,4,4,14,0,0,0,0,0,0,4],
        [4,11,11,11,0,14,4,4,11,11,11,11,2,3,12,4,4,13,11,0,0,0,4,4,4,4,11,11,11,11,11,4],
        [4,0,0,0,12,4,4,4,0,0,1,0,2,3,3,4,4,2,0,0,0,12,4,4,4,4,0,0,0,0,0,4],
        [4,13,11,2,0,14,4,4,11,11,1,1,1,1,1,1,1,1,1,1,11,0,4,4,4,4,4,12,2,11,13,4],
        [4,11,10,2,12,4,4,4,4,14,0,0,0,2,2,2,3,3,2,1,0,0,0,0,14,4,4,0,2,10,11,4],
        [4,0,11,2,0,0,4,4,4,4,14,0,11,0,0,2,3,3,2,1,1,1,11,11,14,4,4,12,2,11,0,4],
        [4,13,0,0,0,0,4,4,4,4,4,12,0,0,13,2,3,3,2,1,0,0,0,0,14,4,4,0,0,0,13,4],
        [4,0,11,11,11,11,4,4,4,4,4,0,11,11,0,2,3,3,2,1,11,11,11,11,14,4,4,0,11,11,0,4],
        [4,0,0,0,2,0,4,4,4,4,4,0,0,0,0,2,3,3,2,0,0,0,0,0,4,4,4,0,0,2,0,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 11 „Ç≠„É°„É≥
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,0,4,4,4,0,4,4,4,4],
        [4,4,4,0,4,4,0,0,0,4,0,11,0,4,4,4],
        [4,4,4,11,2,2,11,0,11,0,11,0,4,4,4,4],
        [4,4,11,10,2,2,2,11,0,0,0,0,0,4,4,4],
        [4,2,2,11,2,2,0,0,0,3,3,3,3,0,4,4],
        [4,2,0,2,2,0,3,3,2,2,2,2,2,2,4,4],
        [4,4,11,0,0,3,2,2,2,0,0,0,0,0,4,4],
        [4,0,0,11,0,3,2,2,0,11,11,11,11,11,4,4],
        [4,11,0,0,0,3,2,2,11,0,2,2,2,2,4,4],
        [4,4,0,11,0,0,2,2,0,11,2,11,11,4,4,4],
        [4,4,11,4,11,3,2,2,11,0,2,11,10,4,4,4],
        [4,4,4,4,4,3,2,2,2,11,2,2,3,3,4,4],
        [4,4,4,4,4,4,2,4,4,2,3,3,3,3,4,4],
        [4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,4],
    ],
    // Stage 12 „Éö„Ç±
    [
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,0,0,0,0,3,3,3,3,3,3],
        [3,3,0,0,0,0,0,0,1,1,1,1,1,1,1,2,2,0,0,2,4,4,4,11,11,1,0,3,3,3,3,3],
        [3,0,11,13,13,1,1,1,1,2,2,2,2,2,1,0,0,11,11,4,4,4,4,4,0,1,0,0,0,3,3,3],
        [3,11,10,11,0,4,4,4,1,1,1,0,0,1,1,11,11,1,14,4,4,4,4,4,0,1,0,0,0,3,3,3],
        [3,0,11,1,12,4,4,4,4,4,1,11,11,1,4,4,4,4,4,4,4,4,14,0,0,1,13,0,0,0,3,3],//5
        [3,0,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,11,11,1,0,11,11,0,3,3],
        [3,11,11,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,1,1,1,1,0,0,3],
        [3,0,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,1,1,0,0,1,0,0,3],
        [3,11,1,2,2,1,1,1,4,4,4,4,4,4,2,2,4,4,4,4,14,0,11,11,1,0,3,3,1,11,0,3],
        [3,1,0,0,0,2,2,1,1,14,4,4,14,0,0,4,4,4,4,4,4,0,1,1,1,0,0,0,1,0,0,3],//10
        [3,1,11,11,0,2,2,2,1,14,4,4,4,11,0,14,4,4,4,4,0,0,1,0,1,0,15,15,1,15,15,15],
        [3,1,2,2,2,2,2,1,1,14,4,4,4,2,4,4,4,4,14,0,1,1,1,0,1,0,15,0,1,0,0,3],
        [3,1,2,2,2,2,1,1,4,4,4,4,4,4,4,4,4,4,4,0,1,0,0,0,1,15,15,0,1,0,0,3],
        [3,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,0,0,0,0,1,0,15,15,1,15,0,0,1,1,1,3],
        [3,0,0,0,1,0,14,4,4,4,4,4,4,4,4,4,12,11,11,1,1,0,15,0,1,0,0,0,0,0,1,3],//15
        [3,11,11,11,1,0,14,4,4,4,4,4,4,4,4,4,0,0,0,1,0,0,15,0,1,1,1,11,11,11,1,3],
        [3,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,15,15,15,1,15,15,15,0,0,1,3,3,0,0,1,3],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,1,0,0,0,0,11,1,0,0,0,0,1,3],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,0,1,1,1,1,0,3,1,16,16,16,16,1,3],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,0,0,0,1,3,3,1,16,16,16,16,1,3],//20
        [4,4,0,4,4,4,14,14,4,4,4,4,4,4,4,4,4,4,2,11,11,11,1,3,0,1,0,0,0,0,1,3],
        [4,4,12,4,4,14,0,0,14,4,4,4,4,4,4,4,4,4,4,4,2,2,1,0,0,1,2,2,2,2,0,3],
        [4,4,1,4,4,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,2,2,11,11,1,1,1,1,11,13,3],
        [0,0,1,0,0,0,0,0,11,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,11,10,11,3],
        [0,0,1,0,0,0,0,11,1,11,1,0,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,13,0,11,3,3],//25
        [11,11,1,0,0,0,0,1,0,0,1,1,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,0,3,3],
        [0,0,1,1,1,13,11,1,0,0,0,1,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3],
        [3,0,0,0,1,0,0,0,0,16,16,1,11,11,1,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,3],
        [3,3,3,0,1,11,11,0,0,16,16,0,0,0,1,1,11,11,0,0,4,4,4,4,4,4,4,4,4,4,4,3],
        [3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3],
    ],
    // Stage 13 „Ç¢„É©„É©
    [
        [4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
        [4,3,3,3,0,0,3,3,3,3,3,0,3,3,3,3,0,3,3,3,3,3,3,3,3,3,3,3,0,3,3,3],
        [3,3,0,11,0,13,0,0,0,0,0,11,3,3,3,0,13,0,0,0,3,3,3,0,0,0,3,3,11,3,3,3],
        [3,0,11,10,11,0,0,3,3,3,0,0,0,0,3,3,0,0,11,0,0,0,0,0,11,0,0,0,0,3,3,3],
        [3,0,0,11,0,0,0,3,3,3,11,3,3,0,3,0,0,3,3,3,3,3,0,0,0,0,3,3,0,3,3,3],
        [3,0,13,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0,3,3,3,3,11,11,11,3,3,3,0,0,3,3],
        [3,3,0,0,3,3,0,0,3,3,3,3,3,0,3,3,0,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3],
        [3,3,0,3,3,3,0,0,0,0,0,0,0,0,3,3,0,3,3,3,3,3,3,3,3,3,3,3,3,0,11,3],
        [3,3,0,3,3,3,11,11,11,3,3,3,0,3,3,3,0,3,3,0,3,3,3,3,3,3,0,3,3,0,0,3],
        [3,0,0,3,3,3,3,3,3,3,3,3,0,3,3,3,0,0,0,0,0,0,3,3,3,3,11,3,0,0,0,3],
        [3,0,3,3,3,3,3,3,3,3,3,0,0,0,0,0,11,0,3,3,3,0,0,0,0,3,0,0,0,0,0,3],
        [3,0,0,0,3,3,3,3,0,3,3,0,3,0,3,0,0,0,3,0,3,3,3,3,0,0,0,0,11,13,3,3],
        [3,11,3,0,0,0,0,0,11,0,0,0,3,13,3,11,0,3,3,11,0,0,3,3,0,0,0,11,10,11,3,3],
        [3,3,3,3,3,3,3,11,3,3,3,3,3,3,3,3,13,3,3,3,11,11,3,3,3,0,13,0,11,0,3,4],
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4],
    ],
    // Stage 14 „ÉÅ„É™„ÉÇ„É™
    [
        [2,2,2,2,0,0,15,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,15,0,0,2,2],
        [2,2,2,2,0,0,15,0,0,0,0,0,0,0,0,0,0,2,2,2,0,2,0,0,0,0,0,15,0,2,2,2],
        [2,2,0,0,0,0,15,0,0,11,11,11,11,11,11,11,0,0,0,0,13,0,11,11,11,11,0,1,0,0,0,2],
        [2,2,0,11,0,0,15,15,0,0,0,0,0,0,0,0,0,15,15,15,15,15,0,0,0,0,0,15,0,11,0,2],
        [2,2,11,0,0,0,0,15,15,15,15,15,15,15,15,15,15,15,0,0,0,15,15,15,15,15,15,15,0,0,0,2],
        [2,2,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,2],
        [2,2,2,0,0,3,0,0,0,15,0,0,0,0,0,0,0,0,0,11,0,0,0,0,15,0,0,0,2,11,13,2],
        [2,2,0,0,0,3,0,0,0,15,15,15,1,15,0,11,11,0,11,0,15,15,15,15,15,0,11,0,11,10,11,2],
        [2,2,11,0,13,3,0,0,0,15,15,0,0,0,15,15,15,0,0,0,15,0,0,1,0,0,2,0,0,11,2,2],
        [2,11,10,11,0,0,0,0,15,15,15,0,0,0,0,0,15,15,15,15,15,0,0,1,0,0,0,0,11,2,2,2],
        [2,2,11,0,0,0,0,0,15,0,0,0,0,0,0,0,15,0,0,0,0,0,0,15,15,15,15,0,0,0,2,2],
        [2,0,0,0,0,0,15,15,15,0,0,0,3,0,0,15,15,0,0,0,0,0,15,15,0,0,15,0,0,11,0,2],
        [2,0,11,0,0,0,15,0,0,0,0,3,0,0,0,15,0,0,11,0,15,15,15,0,0,0,15,15,0,0,2,2],
        [2,2,0,11,0,0,15,0,2,2,11,0,0,13,0,15,0,0,0,0,15,0,0,0,11,0,0,15,0,11,0,2],
        [2,2,2,2,0,0,15,0,2,2,2,2,2,2,0,15,0,2,2,0,15,0,2,2,2,2,0,15,0,0,2,2],
    ],
    // Stage 15 „Éé„Ç¢„Ç´„Ç∂„É≥
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,0,4,0,1,1,1,1,2,2,2,2,2,4],
        [4,0,0,11,1,11,1,0,0,3,3,0,0,2,2,4],
        [4,11,11,0,0,0,1,0,3,3,3,11,3,0,2,4],
        [4,0,1,0,13,0,11,3,3,3,3,3,0,11,1,4],
        [4,4,1,1,1,11,10,3,3,3,3,3,0,0,1,4],
        [4,4,1,0,0,11,3,3,3,3,3,0,3,11,1,4],
        [4,0,1,11,0,3,3,3,3,3,0,11,0,0,1,4],
        [4,11,1,0,0,3,3,3,3,3,11,10,1,1,1,4],
        [4,2,2,3,3,3,3,3,3,0,0,11,0,0,4,4],
        [4,2,2,3,3,3,3,0,0,0,0,1,0,13,4,4],
        [4,2,2,0,0,3,0,2,0,0,11,1,11,0,0,4],
        [4,0,2,11,11,2,2,2,0,11,0,1,0,0,11,4],
        [4,11,2,2,2,2,2,4,2,1,1,1,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 16 „ÉÑ„Ç≠„Éé„ÉØ
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,0,0,0,14,14,4,4,4,4],
        [4,4,4,14,0,2,2,2,2,11,0,0,0,4,4,4],
        [4,4,14,0,2,0,11,0,2,2,11,11,0,14,4,4],
        [4,14,0,11,0,11,10,11,0,0,2,2,0,0,4,4], //5
        [4,14,11,0,0,0,0,0,12,0,0,0,11,0,14,4],
        [4,14,0,11,0,0,12,0,4,4,11,0,0,0,14,4],
        [4,14,0,0,0,11,4,14,4,4,4,11,0,0,14,4],
        [4,4,11,0,0,14,4,4,4,4,4,14,0,11,14,4],
        [4,4,4,11,0,14,4,4,4,4,4,14,0,0,14,4], //10
        [4,4,4,0,0,14,4,4,4,4,4,0,11,0,4,4],
        [0,4,4,14,11,0,4,4,4,4,4,4,0,4,4,4],
        [11,0,4,4,4,14,4,4,4,4,4,4,14,4,4,14],
        [0,0,14,4,4,4,4,4,4,4,4,4,4,4,14,0],
        [11,14,4,4,4,4,4,4,4,4,4,4,4,14,0,0], //15
        [14,4,4,4,14,4,4,4,4,4,4,14,4,4,11,11],
        [4,4,4,0,0,4,4,4,4,4,4,0,4,4,4,0],
        [4,4,14,11,0,4,4,4,4,4,4,11,0,14,4,4],
        [4,4,14,0,11,14,4,4,4,4,4,4,0,0,14,4],
        [4,4,4,0,0,4,4,4,4,4,4,4,0,11,14,4], //20
        [4,14,0,11,11,4,4,4,4,4,4,0,11,0,14,4],
        [4,14,0,0,0,0,0,4,4,4,0,11,0,0,14,4],
        [4,4,11,11,0,11,11,4,4,4,12,0,0,11,14,4],
        [4,4,14,0,2,0,2,2,2,11,0,2,11,0,14,4],
        [4,4,14,0,2,11,0,0,11,10,11,0,0,14,4,4],//25
        [4,4,4,11,0,0,11,0,0,11,0,0,11,4,4,4],
        [4,4,4,4,14,0,0,2,2,2,12,4,4,4,4,4],
        [4,4,4,4,4,14,14,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 17 „Éè„Éû„Ç≠
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,14,14,14,14,14,14,4,4,4,4,4,4,0,4,4,4,4,4,4,14,4,4,4,4,4,4,4,4,4,14,14,14,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,4,4,4,0,0,0,12,4,4,4,4,0,0,0,14,14,14,14,4,4,4,4,3,0,0,0,4,4,4,4,4,4],
        [4,4,4,14,0,0,0,0,0,0,0,0,0,2,2,0,0,4,0,0,0,13,0,3,3,3,0,11,1,2,0,3,0,0,14,14,3,3,3,11,0,0,0,0,4,4,4,4], //5
        [4,4,4,4,12,0,0,11,0,0,11,0,11,0,0,3,0,0,0,2,2,2,0,3,3,3,0,0,1,2,0,3,0,0,0,0,3,3,3,3,0,11,0,0,4,4,4,4],
        [4,4,4,0,0,11,0,2,2,3,1,11,1,1,0,3,2,2,11,0,2,2,0,3,3,3,0,0,1,0,11,0,0,11,11,2,3,3,3,3,2,2,0,13,0,4,4,4],
        [4,4,4,0,11,10,13,2,2,3,1,0,0,1,0,3,2,2,2,3,2,2,0,3,1,1,1,1,1,11,1,1,11,0,0,0,3,1,1,1,1,1,13,0,0,4,4,4],
        [4,4,4,0,0,11,1,2,2,3,1,0,3,1,2,2,0,2,2,3,1,1,1,1,1,3,0,0,0,0,0,1,2,0,0,1,1,1,3,3,0,11,10,11,0,4,4,4],
        [4,4,4,0,13,0,1,1,1,1,1,0,3,1,1,1,11,1,1,1,1,0,0,3,3,3,0,11,0,0,3,1,1,11,1,1,3,3,3,3,0,0,11,0,0,4,4,4], //10
        [4,4,4,0,0,2,2,2,0,2,2,2,2,0,2,2,2,2,2,0,0,11,0,3,3,0,0,2,2,0,3,0,0,2,2,2,3,3,3,3,0,0,0,12,14,4,4,4],
        [4,4,4,14,0,0,0,0,11,0,0,4,0,11,0,0,0,0,0,14,14,0,0,3,3,12,0,4,4,13,0,0,11,0,0,0,3,3,3,0,0,11,14,14,4,4,4,4],
        [4,4,4,4,4,4,0,0,0,14,14,4,14,0,0,14,14,14,14,4,4,4,4,4,4,4,4,4,4,4,0,0,0,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,14,14,14,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,14,14,14,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 18 „Çµ„Ç§„Ç≥„É≠
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4],
        [4,4,4,0,4,4,4,4,0,4,4,4,4,0,4,4,4,11,4,4,4,4,4,4,4,0,4,4,13,4,4,4],
        [4,4,4,0,4,4,4,4,0,4,4,4,4,0,4,4,4,1,4,4,4,4,4,4,4,11,4,4,0,4,4,4],
        [4,4,4,11,0,0,0,0,0,0,4,4,4,0,4,4,4,1,4,4,4,4,0,0,0,0,0,2,2,4,4,4], //5
        [4,4,4,0,0,11,13,0,1,11,1,1,1,1,1,1,1,1,1,1,1,1,1,11,0,3,0,0,0,4,4,4],
        [4,4,4,0,11,10,11,1,1,0,4,4,4,4,4,0,4,4,4,0,4,4,0,0,3,3,3,0,11,4,4,4],
        [4,4,4,0,0,11,0,0,0,0,4,4,4,4,4,0,4,4,4,0,4,4,3,0,3,3,3,3,0,4,4,4],
        [4,4,4,0,13,0,0,0,0,0,4,4,4,4,4,0,0,4,4,0,4,4,3,0,0,3,3,0,0,4,4,4],
        [4,4,4,0,0,0,0,0,3,3,4,4,4,4,4,4,11,2,2,2,2,2,0,0,0,0,0,11,0,4,4,4], //10
        [4,4,4,3,3,3,3,3,3,0,4,4,2,4,4,4,4,4,0,4,4,4,11,3,3,3,3,0,0,4,4,4],
        [4,4,4,4,1,4,4,4,4,11,4,4,2,2,4,4,4,4,0,4,4,4,1,4,4,4,4,0,4,4,4,4],
        [4,4,4,4,1,4,4,4,4,1,4,4,4,4,4,4,4,4,11,4,4,4,1,4,4,4,4,0,4,4,4,4],
        [4,4,4,4,1,4,4,4,4,1,4,4,4,4,4,4,4,4,0,4,4,4,1,4,4,4,4,0,4,4,4,4],
        [4,4,4,0,1,1,1,4,4,1,4,4,4,4,4,0,0,0,2,2,2,0,1,4,4,1,1,11,1,4,4,4], //15
        [4,4,4,0,4,4,1,1,1,1,0,2,2,2,0,11,13,4,4,4,4,4,1,1,1,1,4,4,1,4,4,4],
        [4,4,4,11,4,4,4,4,1,4,4,4,4,0,4,4,4,4,4,4,4,4,4,0,4,4,4,4,1,4,4,4],
        [4,4,4,0,4,4,4,4,1,4,4,4,4,0,4,4,4,4,4,4,4,4,4,1,4,4,4,4,1,4,4,4],
        [4,4,4,0,4,4,4,4,1,4,4,4,4,0,4,4,4,4,2,2,4,4,4,0,4,4,4,4,1,4,4,4],
        [4,4,4,0,0,2,2,2,1,1,4,4,4,0,4,4,4,4,4,2,4,4,0,11,0,0,0,0,1,4,4,4], //20
        [4,4,4,0,11,0,0,0,0,1,1,1,1,11,1,1,4,4,4,4,4,4,2,2,2,2,0,0,1,4,4,4],
        [4,4,4,11,0,0,3,3,3,0,4,4,0,4,4,1,1,4,4,4,4,4,2,2,0,0,0,13,1,4,4,4],
        [4,4,4,0,3,3,3,3,0,0,4,4,0,4,4,4,1,4,4,4,4,4,0,0,0,13,11,0,1,4,4,4],
        [4,4,4,0,0,3,3,3,0,11,4,4,0,4,4,4,1,4,4,4,4,4,0,0,0,11,10,11,1,4,4,4],
        [4,4,4,2,13,0,3,3,3,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,1,1,11,0,0,4,4,4], //25
        [4,4,4,2,2,11,1,2,2,2,4,4,4,11,4,4,4,2,4,4,4,4,0,1,2,2,2,0,0,4,4,4],
        [4,4,4,0,4,4,1,4,4,4,4,4,4,0,4,4,4,2,4,4,4,4,4,1,4,4,4,4,0,4,4,4],
        [4,4,4,0,4,4,1,4,4,4,4,4,4,0,4,4,4,2,4,4,4,4,4,1,4,4,4,4,0,4,4,4],
        [4,4,4,11,1,1,1,1,1,1,1,1,1,11,1,1,1,1,1,1,1,1,1,1,0,2,2,2,0,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 19 „Éï„Çø„Ç¥
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,2,2,0,0,0,2,2,0,0,0,0,4,4,4,4,4,4,0,2,2,0,0,15,0,0,2,2,0,4,4],
        [4,0,1,1,11,11,1,1,1,1,11,1,1,1,0,15,0,0,0,11,1,1,11,0,15,0,11,2,2,11,0,4],
        [4,11,1,0,2,2,2,2,2,0,0,0,0,1,0,15,0,0,11,1,2,2,2,0,15,0,0,0,0,1,0,4],
        [4,0,1,0,2,2,2,2,0,2,3,3,3,1,1,1,1,1,1,1,2,2,2,0,15,3,3,11,3,1,0,4],
        [4,0,1,0,0,2,2,2,11,2,3,0,0,1,0,15,0,0,2,2,2,0,2,0,15,3,3,0,0,1,0,4],
        [4,11,1,13,0,2,2,2,2,2,3,11,1,1,0,15,0,0,0,2,2,11,0,0,15,3,3,0,13,1,11,4],
        [4,10,11,0,0,2,2,2,0,0,0,0,0,1,0,15,15,0,0,0,0,0,0,0,15,15,15,0,2,11,10,4],
        [4,11,1,13,0,0,2,0,0,11,16,16,0,1,0,0,15,0,11,3,3,3,0,0,0,0,15,0,2,1,11,4],
        [4,0,1,0,11,0,0,0,3,0,0,0,0,1,0,0,15,0,0,3,3,3,3,3,1,1,1,2,0,1,0,4],
        [4,0,1,2,2,2,3,0,0,1,1,1,3,1,1,1,1,1,1,0,3,3,3,3,1,0,15,0,11,1,0,4],
        [4,0,1,0,0,2,3,3,0,1,0,0,0,1,0,0,15,0,1,0,3,0,2,1,1,0,15,0,2,2,0,4],
        [4,11,1,11,11,1,1,1,1,1,11,3,1,1,11,0,15,0,1,1,1,11,1,1,0,0,15,0,0,0,11,4],
        [4,4,0,2,2,2,2,2,0,0,2,2,0,4,4,4,4,4,4,2,2,2,2,2,11,0,15,0,11,0,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 20 „Éá„Éì„É©„Éº
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,3,3,3,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,11,0,0,0,0,13,11,0,11,0,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,13,11,11,0,0,11,0,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,14,14,14,4,4,4,4,4,4,4,14,14,4,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,14,4,4,4,4,4,4], //5
        [4,4,4,14,0,2,11,11,11,2,11,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4],
        [4,4,4,14,0,2,2,2,0,2,2,2,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,11,11,0,0,4,4,4,4],
        [4,4,4,4,0,0,2,2,11,1,1,1,11,11,2,2,0,4,4,4,4,4,4,4,4,0,0,0,0,0,0,3,3,0,4,4,4],
        [4,4,4,0,11,11,2,0,1,2,2,2,2,1,1,1,12,4,4,4,14,14,4,0,0,11,0,0,3,3,3,0,0,0,0,4,4],
        [4,4,2,11,1,1,1,11,1,0,3,3,0,1,0,0,2,4,4,4,0,0,0,11,0,0,3,3,0,0,0,0,11,0,0,14,4], //10
        [4,4,0,2,1,2,0,2,1,11,3,3,11,1,11,11,2,4,4,4,0,0,0,0,0,3,0,0,2,2,0,11,0,3,0,14,4],
        [4,4,12,11,1,0,13,0,1,1,1,1,1,1,0,2,4,4,4,0,0,11,0,0,3,1,1,1,1,1,1,1,0,0,0,14,4],
        [4,4,2,2,11,13,2,11,1,0,0,0,2,1,11,2,4,4,4,0,3,0,0,3,1,1,0,0,0,2,2,1,0,11,0,4,4],
        [4,4,0,11,10,11,2,0,1,16,16,16,2,1,1,1,4,4,4,0,3,13,0,0,1,0,3,0,11,0,0,1,0,0,4,4,4],
        [4,4,12,0,11,0,2,11,1,16,16,16,2,2,0,1,1,1,1,1,1,1,0,3,1,0,3,0,0,3,13,1,13,0,4,4,4], //15
        [4,4,4,13,1,13,2,2,1,0,0,0,2,0,3,1,4,4,4,0,0,1,0,3,1,0,3,0,0,11,0,11,0,12,4,4,4],
        [4,4,4,2,1,1,1,1,1,1,1,2,0,2,2,1,4,4,4,0,0,1,0,3,1,0,3,0,0,0,11,10,11,4,4,4,4],
        [4,4,4,2,0,2,1,2,0,2,1,1,11,1,1,1,4,4,4,0,3,1,1,1,1,0,3,0,0,13,0,11,0,4,4,4,4],
        [4,4,4,4,11,2,1,0,11,0,2,2,2,0,2,2,4,4,4,0,3,0,0,3,0,0,3,0,2,2,13,0,12,4,4,4,4],
        [4,4,4,4,2,0,1,11,0,3,0,0,2,13,2,2,4,4,4,0,3,0,0,3,0,0,0,0,0,0,0,0,0,0,4,4,4], //20
        [4,4,4,14,0,11,1,0,3,0,11,11,2,0,1,1,1,1,1,0,0,0,0,0,0,11,0,0,3,3,3,3,3,0,4,4,4],
        [4,4,4,14,0,2,1,2,2,2,3,2,2,3,1,0,4,4,4,0,3,0,0,0,3,0,0,0,2,2,2,2,2,4,4,4,4],
        [4,4,4,14,0,2,1,1,0,2,2,2,0,2,1,11,4,4,4,4,4,12,11,0,0,3,0,11,2,2,0,2,2,4,4,4,4],
        [4,4,4,14,0,0,2,1,11,1,1,1,11,1,1,2,4,4,4,4,4,4,4,0,0,0,3,2,2,2,11,2,4,4,4,4,4],
        [4,4,4,4,4,11,0,0,2,2,0,0,2,2,2,4,4,4,4,4,4,4,4,14,4,0,0,0,2,2,2,4,4,4,4,4,4], //25
        [4,4,4,4,4,4,4,11,0,2,11,11,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,11,0,0,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,12,0,0,0,4,4,4,4,4,4,4,14,14,4,4,4,4,4,4,14,14,14,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,14,14,4,4,4,4,4,4,4,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,11,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,13,11,11,11,0,13,2,2,2,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage 21 ÊúÄÂæå„ÅÆÂ§¢
    [
        [3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4],
        [3,0,0,0,11,1,11,1,11,1,1,11,0,0,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,14,13,13,4,4,4,4,4,4,4],
        [0,0,11,11,1,1,1,0,0,0,0,1,1,11,1,0,0,0,0,0,1,4,4,4,4,4,4,4,4,14,14,4,4,4,4,4,4,4,4],
        [11,1,1,0,0,0,1,0,0,0,11,1,0,1,0,0,13,0,11,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4], //5
        [1,1,0,0,11,2,1,11,11,11,1,1,1,1,1,11,0,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [1,0,2,0,2,2,2,0,0,0,2,2,2,0,1,1,11,1,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [1,2,2,11,2,2,2,2,2,11,0,2,0,0,2,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [1,0,2,0,2,2,0,2,2,2,11,0,11,11,2,0,0,2,4,4,4,4,4,4,0,4,4,4,4,4,4,4,4,4,4,4,4,14,14],
        [1,11,0,0,0,2,11,0,0,2,2,2,2,2,0,0,2,2,4,4,4,4,4,4,12,4,4,4,4,4,4,4,4,4,4,14,14,0,0], //10
        [2,2,2,2,0,0,0,2,0,0,2,2,2,0,0,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,4,0,0,2,0],
        [2,2,0,2,2,0,2,2,2,11,2,2,0,0,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,4,0,4,12,13,0,0],
        [2,0,0,0,0,0,0,2,2,0,2,0,0,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,14,14,2,4,12,1,11,1,13,0],
        [2,0,2,2,2,2,0,0,2,0,0,0,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,14,14,0,0,3,0,1,11,10,11,1,0],
        [2,0,0,2,2,2,2,0,0,0,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,3,0,0,0,1,11,1,0,0], //15
        [2,2,0,2,2,2,2,2,0,2,2,2,2,4,4,4,4,4,0,4,4,4,4,4,4,14,0,0,0,3,0,0,0,11,0,1,0,13,0],
        [2,2,0,0,2,2,2,2,0,2,2,2,4,4,4,4,4,4,12,4,4,4,4,4,14,0,0,0,2,0,0,11,11,1,1,1,11,0,0],
        [2,2,2,0,2,2,2,0,0,2,2,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,0,0,1,1,1,1,1,0,1,0,2,0],
        [2,0,0,0,0,0,0,0,2,2,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,2,11,11,1,0,0,0,0,11,1,0,0,2],
        [0,13,1,11,1,11,1,0,0,14,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,2,2,1,1,1,11,11,0,3,0,1,1,0,0], //20
        [1,0,11,10,11,0,1,1,14,4,4,4,4,4,4,4,4,4,4,4,14,0,0,3,0,2,0,0,0,1,0,0,3,3,3,0,1,11,0],
        [1,13,0,11,1,12,14,14,4,4,4,4,4,4,4,4,4,4,4,14,0,0,3,0,0,0,0,0,3,1,0,3,3,3,3,0,1,0,0],
        [1,1,12,1,14,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,3,3,0,11,11,11,0,0,1,0,0,0,3,0,0,1,11,0],
        [0,1,4,14,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,3,3,0,0,1,1,1,1,1,1,11,11,11,0,0,11,1,0,0],
        [14,14,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,3,3,0,0,0,11,1,0,0,0,0,1,1,1,1,1,13,1,1,11,0], //25
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,12,0,0,13,1,1,1,1,0,3,0,11,0,0,0,0,3,0,0,1,0,0],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,1,11,0,0,1,0,0,0,3,0,0,0,0,2,2,2,3,0,11,1,0,3],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,1,0,0,1,0,2,0,0,11,11,0,0,0,0,0,0,0,0,1,0,3],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,11,1,11,11,1,1,1,1,1,1,1,1,1,1,11,11,11,11,1,1,0,3],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
    ],
    // Stage a „Éû„Éº„Çπ„Çø„Éì
    [
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,2,0,4,4,4,4,4],
        [4,4,4,4,1,1,1,1,0,4,4,4,4,4,4,4,0,4,4,11,11,11,0,2,11,2,0,0,4,4,4],
        [4,4,4,1,3,3,3,1,3,4,4,4,4,4,4,11,0,0,0,0,0,0,0,0,0,11,11,0,0,4,4],
        [4,4,0,1,3,3,3,1,3,3,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,4,4],
        [4,4,0,1,3,10,3,1,3,3,3,4,4,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,4],
        [4,4,0,1,1,1,1,2,3,3,3,3,3,3,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4],
        [4,4,0,0,0,0,0,0,2,3,3,3,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,0,4,4],
        [4,4,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,4,4,4,4,0,0,10,0,0,0,4,4],
        [4,4,0,11,11,0,0,0,2,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,4,4],
        [4,4,0,11,11,0,0,0,0,11,0,0,0,0,2,0,0,4,4,4,0,11,11,0,0,0,0,0,0,4,4],
        [4,4,0,0,0,0,0,0,0,0,0,0,2,2,4,4,4,4,4,4,0,11,11,0,0,2,0,0,4,4,4],
        [4,4,4,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,0,0,2,0,11,0,4,4,4,4],
        [4,4,4,4,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,2,2,4,4,4,4,4],
        [4,4,4,4,4,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
    ],
    // Stage a „Ç´„Ç≥„Çª„Ç§„Éè„É≥„Éà„Ç¶
    [
        [0,0,0,0,0,0,0,0,10,0,0,0,0,2,2],
        [0,2,0,0,3,0,0,0,0,0,0,0,0,2,2],
        [0,0,0,3,3,3,3,0,0,0,2,0,0,0,2],
        [0,0,2,3,0,3,0,0,0,0,0,3,0,0,0],
        [0,0,0,0,0,0,0,2,0,0,0,0,3,3,3],
        [4,4,4,0,0,0,0,11,0,0,11,0,0,0,3],
        [0,0,4,4,4,0,2,0,0,0,0,2,0,0,0],
        [0,0,0,0,4,4,4,0,0,0,0,0,0,2,0],
        [0,0,2,2,0,0,4,4,0,0,4,4,4,0,0],
        [0,0,0,0,0,0,0,4,1,1,4,0,4,4,4],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,2,0,0,0,0,11,0,0,11,0,2,2,0],
        [0,2,2,0,0,2,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,2,0,0,0,0],
        [0,0,3,0,0,2,0,0,0,0,0,2,2,0,0],
        [0,0,3,3,0,0,0,0,0,0,0,2,2,0,0],
        [0,3,3,3,0,0,0,0,0,0,0,2,2,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,10,0,0,0,0,2,2,0],
        [0,0,2,2,0,0,0,0,0,2,2,0,0,0,0],
    ],
    // Stage a „Ç∏„É£„É≥„ÉúÂú∞‰∏ä
    [
        [2,2,2,2,3,3,3,3,10,10,1,1,3,3,3,3,2,2,2,2],
        [2,2,2,2,3,3,3,3,10,10,1,1,3,3,3,3,2,2,2,2],
        [2,2,11,11,0,0,0,0,1,1,1,1,0,0,0,0,11,11,2,2],
        [2,2,11,11,0,0,0,0,1,1,1,1,0,0,0,0,11,11,2,2],
        [3,3,0,0,13,13,0,0,1,1,1,1,0,0,13,13,0,0,3,3],
        [3,3,0,0,13,13,0,0,1,1,1,1,0,0,13,13,0,0,3,3],
        [3,3,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,3,3],
        [3,3,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,3,3],
        [11,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11,11],
        [11,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11,11],
        [1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1],
        [1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1],
        [1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1],
        [1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1],
        [11,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11,11],
        [11,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11,11],
        [3,3,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,3,3],
        [3,3,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,3,3],
        [3,3,0,0,13,13,0,0,1,1,1,1,0,0,13,13,0,0,3,3],
        [3,3,0,0,13,13,0,0,1,1,1,1,0,0,13,13,0,0,3,3],
        [2,2,11,11,0,0,0,0,1,1,1,1,0,0,0,0,11,11,2,2],
        [2,2,11,11,0,0,0,0,1,1,1,1,0,0,0,0,11,11,2,2],
        [2,2,2,2,3,3,3,3,10,10,1,1,3,3,3,3,2,2,2,2],
        [2,2,2,2,3,3,3,3,10,10,1,1,3,3,3,3,2,2,2,2],
    ],
    // Stage a „Ç∑„Éõ„Ç¶„Éè„ÉÉ„Éà„Ç¶
    [
        [11,2,11,2,11,11,11,2,2,4,4,11,10,13,0,14,4,4,4,4,4,4,4,12,0,0,10],
        [2,10,2,2,2,2,2,2,2,4,4,0,0,0,0,14,4,4,4,4,4,4,4,11,12,12,0],
        [2,2,11,2,2,2,2,2,2,4,4,0,2,2,0,14,4,4,4,3,4,4,4,14,14,14,0],
        [11,2,2,2,2,2,2,2,2,4,4,3,3,3,3,14,4,4,4,3,4,4,4,4,4,4,4],
        [2,2,2,2,2,0,2,2,4,4,4,0,0,0,0,14,4,4,4,4,3,3,4,4,4,4,4],
        [2,2,2,2,2,2,2,2,2,4,4,0,0,0,0,14,4,4,4,4,4,3,4,4,4,4,4],
        [2,3,2,2,2,2,2,2,2,2,4,0,0,3,3,3,4,4,4,4,4,4,4,4,4,4,4],
        [4,2,2,2,2,2,2,0,2,2,2,4,1,1,12,4,4,4,4,4,4,4,4,4,4,4,4],
        [4,2,2,0,2,2,2,2,2,2,2,0,0,0,0,0,14,14,4,4,4,4,4,4,4,4,4],
        [2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4],
        [2,2,2,2,2,2,2,2,2,2,0,11,0,11,0,11,0,0,12,4,14,4,4,4,4,4,4],
        [2,2,2,0,2,0,2,0,2,0,0,0,0,11,13,0,0,0,0,0,0,14,14,14,0,0,0],
        [2,2,0,0,0,0,0,0,0,0,0,0,11,10,11,0,0,0,0,0,0,0,0,0,0,1,0],
        [4,3,3,3,0,0,0,0,2,2,0,0,0,11,0,0,0,0,0,11,0,0,0,11,0,1,0],
        [4,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0],
        [11,11,11,11,11,0,0,0,0,0,0,11,0,11,0,11,0,0,2,0,0,0,0,0,0,1,0],
        [11,11,11,11,1,0,0,16,16,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0],
        [11,11,11,11,1,0,0,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [1,0,0,0,0,0,0,0,0,0,11,0,0,11,0,0,11,0,0,0,0,0,0,0,0,1,0],
        [1,0,0,2,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
        [1,0,0,0,3,3,3,0,0,2,1,0,0,0,0,2,2,2,0,0,0,1,0,2,0,1,0],
        [1,0,0,2,3,3,3,3,3,1,0,0,0,0,0,2,2,2,2,2,2,1,2,2,2,1,0],
        [1,0,3,3,3,3,3,3,3,2,0,0,0,11,11,0,0,0,2,2,0,1,0,0,0,1,0],
        [1,3,3,3,3,3,3,3,3,3,0,0,0,3,0,0,11,11,1,11,11,1,11,11,11,11,11],
        [1,3,3,3,3,3,3,3,3,3,0,0,0,3,0,0,1,1,1,1,1,1,1,1,1,1,1],
        [1,3,3,3,3,3,3,3,3,3,0,0,0,3,2,0,11,11,1,13,13,1,11,11,11,11,11],
        [1,1,3,3,1,11,3,3,3,3,0,0,3,3,3,0,1,1,1,1,1,1,1,1,1,1,1],
        [1,3,3,3,11,11,3,3,3,3,0,3,0,0,3,0,1,11,11,1,1,1,13,1,1,13,11],
        [1,1,1,1,11,10,3,3,3,3,0,3,0,13,0,3,1,11,11,1,1,1,13,13,10,13,13],
    ]
];

const AFFILIATION = [
    // Stage 1
    [
        [ 0, 0, 0, 0, 2, 0, 0, 0, 0, 0],
        [ 0, 2, 0, 0, 0, 0, 0, 0, 2, 0],
        [ 0, 0, 2, 0, 0, 0, 0, 2, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 1, 0, 0, 0, 0, 1, 0, 0], 
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
    ],
    // Stage 2
    [
        [ 0, 0, 0, 0, 2, 2, 0, 0, 0, 0],
        [ 0, 2, 0, 0, 0, 0, 0, 0, 2, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 0, 0, 1, 1, 0, 0, 0, 0],
    ],
    // Stage 3
    [
        [ 0, 0, 0, 0, 2, 0, 0, 0, 0, 0],
        [ 0, 2, 0, 2, 2, 2, 2, 0, 2, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 1, 1, 1, 1, 0, 1, 0],
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
    ],
    // Stage 4
    [
        [ 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
    ],
    // Stage 5-a
    [
        [ 2, 0, 0, 0, 2, 0, 0, 0, 0, 2],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 2, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
    ],
    // Stage 5 „ÇΩ„É©„Éû„É°
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,0,2,0,0,0,0,0,0,0,0,1,0,1,0],
        [0,2,2,0,0,0,2,0,0,1,0,0,0,1,1,0],
        [0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0],
        [0,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 6 „Éâ„Éº„Éä„ÉÉ„ÉÑ
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,2,2,2,0,2,2,2,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,2,0,0,0,0,2,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 7 „Åä„Å´„Åé„Çä
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 8 „Çø„Éû„Çø„Éû
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0],
        [0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],
        [0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 9 „Éû„Ç¨„Çø„Éû
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,2,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,2,2,2,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 10 „Éè„Ç¥„É≠„É¢
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,2,2,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0],
        [0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,2,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0],
        [0,2,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],
        [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 11 „Ç≠„É°„É≥
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0],
        [0,0,0,1,0,0,2,0,2,0,2,0,0,0,0,0],
        [0,0,1,1,0,0,0,2,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,0,0,2,2,2,2,2,0,0],
        [0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,0,0,2,0,2,2,0,0,0],
        [0,0,2,0,2,0,0,0,2,0,0,2,2,0,0,0],
        [0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 12 „Éö„Ç±
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//5
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],//25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 13 „Ç¢„É©„É©
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 14 „ÉÅ„É™„ÉÇ„É™
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0],
        [0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
        [0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 15 „Éé„Ç¢„Ç´„Ç∂„É≥
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 16 „ÉÑ„Ç≠„Éé„ÉØ
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0],
        [0,0,0,0,0,0,2,0,0,0,2,2,0,0,0,0],
        [0,0,0,2,0,2,2,2,0,0,0,0,0,0,0,0], //5
        [0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0],//25
        [0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 17 „Éè„Éû„Ç≠
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0],
        [0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 18 „Çµ„Ç§„Ç≥„É≠
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0], //25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 19 „Éï„Çø„Ç¥
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,2,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,2,0],
        [0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0],
        [0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 20 „Éá„Éì„É©„Éº
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0],
        [0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
        [0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0],
        [0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0], //15
        [0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 21 ÊúÄÂæå„ÅÆÂ§¢
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,2,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,2,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0], //15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0],
        [0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0], //20
        [0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Éû„Éº„Çπ„Çø„Éì
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Ç´„Ç≥„Çª„Ç§„Éè„É≥„Éà„Ç¶
    [
        [0,0,0,0,0,0,0,0,2,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,1,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Ç∏„É£„É≥„ÉúÂú∞‰∏ä
    [
        [0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0],
        [0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0],
        [0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0],
        [0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0],
        [0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Ç∑„Éõ„Ç¶„Éè„ÉÉ„Éà„Ç¶
    [
        [2,0,2,0,2,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,2,0,0,2],
        [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0],
        [0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [2,2,2,2,2,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0],
        [2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,2],
        [0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2],
    ]
];

const PRODUCIBLE = [
    // Stage 1
    [
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 1, 0, 0, 0, 0, 1, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 1, 0, 0, 0, 0, 1, 0, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
    ],
    // Stage 2
    [
        [ 0, 0, 0, 0, 1, 1, 0, 0, 0, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
        [ 0, 0, 0, 0, 1, 1, 0, 0, 0, 0],
    ],
    // Stage 3
    [
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 1, 1, 1, 1, 0, 1, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 1, 0, 1, 1, 1, 1, 0, 1, 0],
        [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
    ],
    // Stage 4
    [
        [ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
    ],
    // Stage 5-a
    [
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ],
    // Stage 5 „ÇΩ„É©„Éû„É°
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0],
        [0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 6 „Éâ„Éº„Éä„ÉÉ„ÉÑ
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 7 „Åä„Å´„Åé„Çä
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 8 „Çø„Éû„Çø„Éû
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0],
        [0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],
        [0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 9 „Éû„Ç¨„Çø„Éû
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,1,1,1,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 10 „Éè„Ç¥„É≠„É¢
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0],
        [0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],
        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 11 „Ç≠„É°„É≥
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 12 „Éö„Ç±
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//5
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],//20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0],//25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 13 „Ç¢„É©„É©
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 14 „ÉÅ„É™„ÉÇ„É™
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0],
        [0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
        [0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 15 „Éé„Ç¢„Ç´„Ç∂„É≥
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 16 „ÉÑ„Ç≠„Éé„ÉØ
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0],//25
        [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 17 „Éè„Éû„Ç≠
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 18 „Çµ„Ç§„Ç≥„É≠
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0], //25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 19 „Éï„Çø„Ç¥
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0],
        [0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],
        [0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 20 „Éá„Éì„É©„Éº
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0], //15
        [0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage 21 ÊúÄÂæå„ÅÆÂ§¢
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //5
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //10
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0], //15
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //20
        [0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], //25
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Éû„Éº„Çπ„Çø„Éì
    [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Ç´„Ç≥„Çª„Ç§„Éè„É≥„Éà„Ç¶
    [
        [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Ç∏„É£„É≥„ÉúÂú∞‰∏ä
    [
        [0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],
        [0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
    ],
    // Stage a „Ç∑„Éõ„Ç¶„Éè„ÉÉ„Éà„Ç¶
    [
        [1,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,1],
        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0],
        [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1],
        [0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1],
    ]
];

const INITIAL_UNITS = [
    [], [], [], [], // Stage 1-4: Empty
    // Stage 5-a
    [
        // {type: UNIT_TYPES.APC, owner: 0, x: 9, y: 1, hp: 90, cargo: {type: UNIT_TYPES.BOMBER}},
        // {type: UNIT_TYPES.INFANTRY, owner: 0, x: 9, y: 0, hp: 90, cargo: {type: UNIT_TYPES.INFANTRY}},
        // {type: UNIT_TYPES.TANK, owner: 1, x: 4, y: 8, hp: 50},
        // {type: UNIT_TYPES.TANK, owner: 0, x: 5, y: 8, hp: 100},
        // {type: UNIT_TYPES.LANDER, owner: 1, x: 2, y: 6, cargo: {type: UNIT_TYPES.INFANTRY, owner: 1}},
        // {type: UNIT_TYPES.LANDER, owner: 0, x: 7, y: 5},
        {type: UNIT_TYPES.TANK, owner: 1, x: 0, y: 8, hp: 100, cargo: {type: UNIT_TYPES.INFANTRY}},
        {type: UNIT_TYPES.APC, owner: 0, x: 5, y: 8, hp: 10, cargo: {type: UNIT_TYPES.INFANTRY}},
    ],
    [], [], [], [], [], [], [], [], [],[],[],[],[],[],[], //5-19 Empty
    // Stage 20 „Éá„Éì„É©„Éº
    [
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 17, y: 2, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 20, y: 3, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 25, y: 7, hp: 100},
        {type: UNIT_TYPES.FIGHTER, owner: 1, x: 20, y: 9, hp: 100},
        {type: UNIT_TYPES.BOMBER, owner: 1, x: 22, y: 9, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 19, y: 13, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 16, y: 14, hp: 100},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 18, y: 14, hp: 100},
        {type: UNIT_TYPES.SUPPLY, owner: 1, x: 19, y: 14, hp: 100},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 19, y: 15, hp: 100},
        {type: UNIT_TYPES.FIGHTER, owner: 1, x: 21, y: 18, hp: 100},
        {type: UNIT_TYPES.BOMBER, owner: 1, x: 23, y: 18, hp: 100},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 19, y: 19, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 16, y: 20, hp: 100},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 18, y: 20, hp: 100},
        {type: UNIT_TYPES.SUPPLY, owner: 1, x: 19, y: 20, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 19, y: 21, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 23, y: 23, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 27, y: 24, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 20, y: 28, hp: 100},
    ],
    // Stage 21 ÊúÄÂæå„ÅÆÂ§¢
    [
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 11, y: 2, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 9, y: 5, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 20, y: 28, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 26, y: 22, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 27, y: 27, hp: 100},
        {type: UNIT_TYPES.BOMBER, owner: 1, x: 26, y: 18, hp: 100},
        {type: UNIT_TYPES.BOMBER, owner: 1, x: 31, y: 15, hp: 100},
        {type: UNIT_TYPES.BOMBER, owner: 1, x: 32, y: 17, hp: 100},
        {type: UNIT_TYPES.FIGHTER, owner: 1, x: 29, y: 13, hp: 100},
        {type: UNIT_TYPES.SHIP, owner: 1, x: 28, y: 13, hp: 100},
        {type: UNIT_TYPES.SHIP, owner: 1, x: 26, y: 13, hp: 100},
        {type: UNIT_TYPES.SHIP, owner: 1, x: 25, y: 14, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 24, y: 25, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 24, y: 28, hp: 100},
        {type: UNIT_TYPES.LANDER, owner: 1, x: 5, y: 22, hp: 100, cargo: {type: UNIT_TYPES.TANK, owner: 1}},
        {type: UNIT_TYPES.LANDER, owner: 1, x: 2, y: 23, hp: 100, cargo: {type: UNIT_TYPES.TANK, owner: 1}},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 5, y: 20, hp: 65},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 1, y: 22, hp: 65},
        {type: UNIT_TYPES.LANDER, owner: 1, x: 5, y: 21, hp: 100},
        {type: UNIT_TYPES.LANDER, owner: 1, x: 2, y: 22, hp: 100},
    ],
    // Stage b „Éû„Éº„Çπ„Çø„Éì
    [
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 7, y: 5, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 3, y: 6, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 5, y: 7, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 6, y: 7, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 6, y: 10, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 12, y: 9, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 14, y: 9, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 14, y: 5, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 5, y: 1, hp: 100},
        {type: UNIT_TYPES.APC, owner: 1, x: 6, y: 1, hp: 100},
        {type: UNIT_TYPES.APC, owner: 1, x: 7, y: 1, hp: 100},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 4, y: 2, hp: 80},
        {type: UNIT_TYPES.ARTILLERY, owner: 1, x: 7, y: 8, hp: 100},
        
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 25, y: 7, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 0, x: 24, y: 6, hp: 100},
    ],
    // Stage b „Ç´„Ç≥„Çª„Ç§„Éè„É≥„Éà„Ç¶
    [
        {type: UNIT_TYPES.TANK, owner: 1, x: 5, y: 2, hp: 45},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 12, y: 2, hp: 45},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 4, y: 5, hp: 45},
        {type: UNIT_TYPES.APC, owner: 1, x: 7, y: 4, hp: 45},
        {type: UNIT_TYPES.TANK, owner: 1, x: 10, y: 4, hp: 45},
        {type: UNIT_TYPES.APC, owner: 1, x: 13, y: 5, hp: 45},
        {type: UNIT_TYPES.TANK, owner: 1, x: 8, y: 8, hp: 45},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 9, y: 8, hp: 45},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 7, y: 11, hp: 45},
        {type: UNIT_TYPES.APC, owner: 1, x: 5, y: 14, hp: 55},
        {type: UNIT_TYPES.TANK, owner: 1, x: 10, y: 13, hp: 55},
        {type: UNIT_TYPES.TANK, owner: 1, x: 8, y: 0, hp: 100},

        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 5, y: 1, hp: 1},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 12, y: 1, hp: 1},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 10, y: 3, hp: 1},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 7, y: 0, hp: 1},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 9, y: 0, hp: 1},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 8, y: 1, hp: 1},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 7, y: 3, hp: 1},
        {type: UNIT_TYPES.APC, owner: 0, x: 6, y: 17, hp: 100},
        {type: UNIT_TYPES.APC, owner: 0, x: 8, y: 17, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 7, y: 18, hp: 100},
        {type: UNIT_TYPES.INFANTRY, owner: 0, x: 8, y: 18, hp: 100},
        {type: UNIT_TYPES.ARTILLERY, owner: 0, x: 9, y: 18, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 0, x: 5, y: 19, hp: 100},
        {type: UNIT_TYPES.SUPPLY, owner: 0, x: 6, y: 19, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 0, x: 9, y: 19, hp: 30},
        {type: UNIT_TYPES.ARTILLERY, owner: 0, x: 7, y: 19, hp: 60},
    ],
    [],
    // Stage a „Ç∑„Éõ„Ç¶„Éè„ÉÉ„Éà„Ç¶
    [
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 5, y: 28, hp: 90},
        {type: UNIT_TYPES.INFANTRY, owner: 1, x: 26, y: 28, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 26, y: 13, hp: 100},
        {type: UNIT_TYPES.TANK, owner: 1, x: 26, y: 14, hp: 100},
        {type: UNIT_TYPES.LANDER, owner: 1, x: 24, y: 1, hp: 100, cargo: {type: UNIT_TYPES.BOMBER, owner: 1}},
        {type: UNIT_TYPES.LANDER, owner: 1, x: 22, y: 0, hp: 100, cargo: {type: UNIT_TYPES.FIGHTER, owner: 1}},
        {type: UNIT_TYPES.ANTIAIR, owner: 1, x: 7, y: 23, hp: 100},
        {type: UNIT_TYPES.ANTIAIR, owner: 1, x: 2, y: 23, hp: 100},
        {type: UNIT_TYPES.SHIP, owner: 1, x: 7, y: 17, hp: 100},
    ]
];

class Game {
    constructor() {
        this.canvas = document.getElementById('gameCanvas');
        this.ctx = this.canvas.getContext('2d');
        this.map = [];
        this.units = [];
        this.buildings = [];
        this.effects = []; 
        this.turn = 0; 
        this.turnCount = 1;
        this.funds = [0, 0];
        this.selectedUnit = null;
        this.selectedTarget = null; 
        this.state = 'IDLE'; 
        this.moveRange = [];
        this.dropRange = [];
        this.cpuMoveRange = [];
        this.infoUnit = null;
        this.cargoCanvas = document.getElementById('cargo-canvas');
        this.cargoCtx = this.cargoCanvas.getContext('2d');
        this.cameraOffset = {x:0, y:0};
        this.tempUnitState = null;
        this.endTurnButtonTimer = null;
        
        this.isDragging = false;
        this.dragStartX = 0;
        this.dragStartY = 0;
        this.lastOffsetX = 0;
        this.lastOffsetY = 0;
        this.dragThreshold = 5; 
        
        this.zoomLevel = 1.0;
        this.minZoom = 0.4;
        this.maxZoom = 2.5;
        this.isPinching = false;
        this.pinchStartDistance = null;

        this.aiStrategy = { mode: 'NORMAL', focus: 'LAND' };

        this.initInput();
        window.addEventListener('resize', () => this.resize(true));
        this.resize(false);
        
        const loop = () => {
            this.update();
            this.draw();
            requestAnimationFrame(loop);
        };
        loop();
    }

    hideEndTurnButton() {
        if (this.endTurnButtonTimer) {
            clearTimeout(this.endTurnButtonTimer);
            this.endTurnButtonTimer = null;
        }
        document.getElementById('end-turn-btn').style.display = 'none';
    }

    showEndTurnButtonWithDelay() {
        if (this.endTurnButtonTimer) {
            clearTimeout(this.endTurnButtonTimer);
        }
        // Don't show if game is over
        if (this.turn === -1) return;

        this.endTurnButtonTimer = setTimeout(() => {
            // Only show if it's player's turn and game is idle or move select state
            if (this.turn === 0 && (this.state === 'IDLE' || this.state === 'MOVE_SELECT')) {
                document.getElementById('end-turn-btn').style.display = 'block';
            }
            this.endTurnButtonTimer = null;
        }, 500); // 0.5 second delay
    }

    update() {
        if (this.infoUnit && !this.units.includes(this.infoUnit)) {
            this.clearInfo();
        }
        this.updateEffects();
        this.updateAnimations();
    }

    updateAnimations() {
        if (this.state !== 'ANIMATING' && !this.units.some(u => u.isAnimating)) return;

        const justFinished = [];
        let stillAnimatingCount = 0;
        
        this.units.forEach(unit => {
            if (unit.isAnimating) {
                const speed = (0.03 * animationSpeed);
                unit.animProgress += speed;

                if (unit.animProgress >= 1) {
                    unit.animProgress = 1;
                    justFinished.push(unit);
                } else {
                    stillAnimatingCount++;
                }
            }
        });

        justFinished.forEach(unit => {
            unit.isAnimating = false;
            unit.x = unit.animEndX;
            unit.y = unit.animEndY;

            if (unit.animOnComplete) {
                unit.animOnComplete();
            }
            // Cleanup animation properties
            delete unit.isAnimating;
            delete unit.animProgress;
            delete unit.animStartX;
            delete unit.animStartY;
            delete unit.animEndX;
            delete unit.animEndY;
            delete unit.animOnComplete;
        });
        
        if (stillAnimatingCount === 0 && this.state === 'ANIMATING') {
            // Allow state to be changed by onComplete callbacks.
            // If nothing changed it, reset to IDLE as a fallback.
            if(this.state === 'ANIMATING') this.state = 'IDLE';
        }
    }

    animateUnitMove(unit, toX, toY) {
        return new Promise(resolve => {
            if (!isAnimationEnabled || animationSpeed <= 0) {
                unit.x = toX;
                unit.y = toY;
                resolve();
                return;
            }
            
            this.state = 'ANIMATING';

            unit.isAnimating = true;
            unit.animProgress = 0;
            unit.animStartX = unit.x; // Grid coords
            unit.animStartY = unit.y; // Grid coords
            unit.animEndX = toX;       // Grid coords
            unit.animEndY = toY;       // Grid coords
            unit.animOnComplete = resolve;
        });
    }

    get effectiveTileSize() {
        return BASE_TILE_SIZE * this.zoomLevel;
    }

    resize(draw = true) {
        const w = window.innerWidth;
        const h = window.innerHeight;
        this.canvas.width = w;
        this.canvas.height = h;
        const TILE_SIZE = this.effectiveTileSize;
        this.cameraOffset.x = Math.floor((w - COLS * TILE_SIZE) / 2);
        this.cameraOffset.y = Math.floor((h - ROWS * TILE_SIZE) / 2);
        if (COLS * TILE_SIZE > w) this.cameraOffset.x = 20;
        if (ROWS * TILE_SIZE > h) this.cameraOffset.y = 50;
    }

    initStage(idx) {
        this.map = JSON.parse(JSON.stringify(STAGES[idx]));
        const aff = AFFILIATION[idx];
        const prod = PRODUCIBLE[idx];
        ROWS = this.map.length;
        COLS = this.map[0].length;
        this.resize(false);

        this.units = [];
        this.buildings = [];
        this.effects = [];
        this.turn = 0;
        this.funds = [4000, 4000];
        this.state = 'IDLE';
        this.selectedUnit = null;
        this.selectedTarget = null;

        // Initial Units
        if (INITIAL_UNITS[idx]) {
            INITIAL_UNITS[idx].forEach(d => {
                const u = {
                    type: d.type, owner: d.owner, x: d.x, y: d.y,
                    hp: d.hp !== undefined ? d.hp : 100,
                    ammo: d.ammo !== undefined ? d.ammo : UNITS[d.type].maxAmmo,
                    finished: false
                };
                if (d.cargo) {
                    u.cargo = {
                        type: d.cargo.type, owner: d.owner, x: d.x, y: d.y,
                        hp: d.cargo.hp !== undefined ? d.cargo.hp : 100,
                        ammo: d.cargo.ammo !== undefined ? d.cargo.ammo : UNITS[d.cargo.type].maxAmmo,
                        finished: false
                    };
                }
                this.units.push(u);
            });
        }

        for(let y=0; y<ROWS; y++) {
            for(let x=0; x<COLS; x++) {
                const t = this.map[y][x];
                const ownerVal = aff[y][x];
                const prodVal = prod[y][x];
                
                // Error Check 1: Invalid affiliation value
                if (ownerVal !== 0 && ownerVal !== 1 && ownerVal !== 2) {
                    alert(`Error in AFFILIATION data at Stage ${idx+1} (${x},${y}): Invalid value ${ownerVal}. Must be 0, 1, or 2.`);
                    console.error(`Invalid affiliation value ${ownerVal} at ${x},${y}`);
                    return;
                }

                // Error Check 2: Invalid producible value
                if (prodVal !== 0 && prodVal !== 1) {
                    alert(`Error in PRODUCIBLE data at Stage ${idx+1} (${x},${y}): Invalid value ${prodVal}. Must be 0 or 1.`);
                    console.error(`Invalid producible value ${prodVal} at ${x},${y}`);
                    return;
                }

                // Building logic
                if (BUILDING_IDS.includes(t)) {
                    let owner = -1;
                    if (ownerVal === 1) owner = 0; // Blue
                    if (ownerVal === 2) owner = 1; // Red
                    
                    // producible flag
                    this.buildings.push({x, y, type: t, owner: owner, capture: 20, producible: (prodVal === 1)});
                } else {
                    // Error Check 3: Affiliation assigned to non-building
                    if (ownerVal !== 0) {
                        alert(`Error in AFFILIATION data at Stage ${idx+1} (${x},${y}): Non-building terrain cannot have affiliation.`);
                        console.error(`Affiliation assigned to non-building terrain type ${t} at ${x},${y}`);
                        return;
                    }
                    // Error Check 4: Producible assigned to non-building
                    if (prodVal !== 0) {
                        alert(`Error in PRODUCIBLE data at Stage ${idx+1} (${x},${y}): Non-building terrain cannot be producible.`);
                        console.error(`Producible assigned to non-building terrain type ${t} at ${x},${y}`);
                        return;
                    }
                }
            }
        }
        this.updateUI();
    }

    screenToGrid(sx, sy) {
        const TILE_SIZE = this.effectiveTileSize;
        const x = Math.floor((sx - this.cameraOffset.x) / TILE_SIZE);
        const y = Math.floor((sy - this.cameraOffset.y) / TILE_SIZE);
        if (x >= 0 && x < COLS && y >= 0 && y < ROWS) return {x, y};
        return null;
    }

    getTouchDistance(touches) {
        const dx = touches[0].clientX - touches[1].clientX;
        const dy = touches[0].clientY - touches[1].clientY;
        return Math.sqrt(dx * dx + dy * dy);
    }

    getTouchCenter(touches) {
        return {
            x: (touches[0].clientX + touches[1].clientX) / 2,
            y: (touches[0].clientY + touches[1].clientY) / 2
        };
    }
    
    zoomOnPoint(scaleMultiplier, screenX, screenY) {
        const currentTileSize = this.effectiveTileSize;
        const worldX = (screenX - this.cameraOffset.x) / currentTileSize;
        const worldY = (screenY - this.cameraOffset.y) / currentTileSize;

        const oldZoom = this.zoomLevel;
        this.zoomLevel *= scaleMultiplier;
        this.zoomLevel = Math.max(this.minZoom, Math.min(this.maxZoom, this.zoomLevel));

        if (oldZoom === this.zoomLevel) return;

        const newTileSize = this.effectiveTileSize;
        this.cameraOffset.x = screenX - worldX * newTileSize;
        this.cameraOffset.y = screenY - worldY * newTileSize;
    }

    initInput() {
        const isMenuOpen = () => {
            const ids = ['menu-overlay', 'message-overlay', 'production-menu', 'help-modal', 'game-menu-modal'];
            return ids.some(id => {
                const el = document.getElementById(id);
                return el.style.display === 'block' || el.style.display === 'flex';
            });
        };
        const isUI = (target) => {
            return target.tagName === 'BUTTON' || target.tagName === 'INPUT' || target.closest('button') || 
                   target.closest('.menu-btn') || target.closest('.action-btn') || 
                   target.closest('#action-menu');
        };

        const handleStart = (e) => {
            if (isMenuOpen() || isUI(e.target)) return;

            if (e.touches) {
                if (e.touches.length === 2) {
                    this.isPinching = true;
                    this.isDragging = false;
                    this.pinchStartDistance = this.getTouchDistance(e.touches);
                    return;
                }
                if (e.touches.length > 1) return; 
            }

            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;

            this.isDragging = false;
            this.dragStartX = cx;
            this.dragStartY = cy;
            this.lastOffsetX = this.cameraOffset.x;
            this.lastOffsetY = this.cameraOffset.y;
        };

        const handleMove = (e) => {
            if (isMenuOpen()) return;

            if (this.isPinching && e.touches && e.touches.length === 2) {
                if (this.pinchStartDistance === null) return;
                
                const newDist = this.getTouchDistance(e.touches);
                const scaleMultiplier = newDist / this.pinchStartDistance;

                const center = this.getTouchCenter(e.touches);
                const rect = this.canvas.getBoundingClientRect();
                const pinchX = center.x - rect.left;
                const pinchY = center.y - rect.top;

                this.zoomOnPoint(scaleMultiplier, pinchX, pinchY);
                
                this.pinchStartDistance = newDist;
                return;
            }

            if (this.dragStartX === null || this.isPinching) return;

            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;
            
            const dx = cx - this.dragStartX;
            const dy = cy - this.dragStartY;
            
            if (!this.isDragging && (Math.abs(dx) > this.dragThreshold || Math.abs(dy) > this.dragThreshold)) {
                this.isDragging = true;
            }

            if (this.isDragging) {
                this.cameraOffset.x = this.lastOffsetX + dx;
                this.cameraOffset.y = this.lastOffsetY + dy;
            }
        };

        const handleEnd = (e) => {
            const generalOverlayIds = ['menu-overlay', 'message-overlay', 'production-menu', 'help-modal', 'game-menu-modal', 'action-menu'];
            const isGeneralOverlayOpen = generalOverlayIds.some(id => {
                const el = document.getElementById(id);
                return el.style.display === 'block' || el.style.display === 'flex';
            });

            // If an overlay is open, we must reset the drag state and then stop further processing.
            if (isGeneralOverlayOpen) {
                this.isDragging = false;
                this.dragStartX = null;
                this.dragStartY = null;
                return;
            }

            let wasPinching = this.isPinching;
            if (this.isPinching && (!e.touches || e.touches.length < 2)) {
                this.isPinching = false;
                this.pinchStartDistance = null;
            }

            // Allow taps on UI buttons, even during targeting states
            if (isUI(e.target)) return;
            
            // Allow handleClick if not dragging/pinching/animating, AND it's a targeting state or IDLE/MOVE_SELECT
            if (!this.isDragging && !wasPinching && this.state !== 'ANIMATING') {
                const isTargetingState = ['TARGET_SELECT', 'CONFIRM_ATTACK', 'REACT_SELECT', 'CONFIRM_REACT', 'DROP_SELECT'].includes(this.state);
                
                // If it's a targeting state, we *want* handleClick to fire so it can select a target.
                // If it's IDLE or MOVE_SELECT, handleClick is also expected to fire (handled by this.turn === 0).
                if (this.turn === 0 || isTargetingState) { // Allow tap for player or any targeting state
                    if (e.cancelable) e.preventDefault();
                    const cx = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
                    const cy = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;
                    const rect = this.canvas.getBoundingClientRect();
                    const pos = this.screenToGrid(cx - rect.left, cy - rect.top);
                    if (pos) this.handleClick(pos.x, pos.y);
                }
            }
            this.isDragging = false;
            this.dragStartX = null;
            this.dragStartY = null;
        };

        this.canvas.addEventListener('wheel', e => {
            if (isMenuOpen()) return;
            e.preventDefault();
            const scaleMultiplier = e.deltaY > 0 ? 0.95 : 1.05;
            const rect = this.canvas.getBoundingClientRect();
            this.zoomOnPoint(scaleMultiplier, e.clientX - rect.left, e.clientY - rect.top);
        }, { passive: false });

        this.canvas.addEventListener('mousedown', handleStart);
        window.addEventListener('mousemove', handleMove);
        window.addEventListener('mouseup', handleEnd);
        this.canvas.addEventListener('touchstart', handleStart, {passive: false});
        window.addEventListener('touchmove', handleMove, {passive: false});
        window.addEventListener('touchend', handleEnd, {passive: false});
        document.getElementById('end-turn-btn').addEventListener('click', () => this.endTurn());
    }

    showToast(msg) {
        const el = document.getElementById('toast-msg');
        el.innerText = msg;
        el.style.opacity = 1;
        if(this.toastTimer) clearTimeout(this.toastTimer);
        this.toastTimer = setTimeout(() => { el.style.opacity = 0; }, 2000);
    }

    addDamageEffect(x, y, damage) {
        const TILE_SIZE = this.effectiveTileSize;
        const effectX = x * TILE_SIZE + TILE_SIZE / 2;
        const effectY = y * TILE_SIZE + TILE_SIZE / 2;
        this.effects.push({ x: effectX, y: effectY, text: damage.toString(), life: 60, offsetY: 0 });
    }

    updateEffects() {
        this.effects.forEach(e => { e.life--; e.offsetY -= 0.5; });
        this.effects = this.effects.filter(e => e.life > 0);
    }

    async handleClick(x, y) {
        if (this.state === 'ANIMATING') return;

        // --- Step 1: Handle ongoing player actions ---
        // If an action is completed, return early.
        if (this.state === 'MOVE_SELECT') {
            const isValidMove = this.moveRange.some(p => p.x === x && p.y === y);
            if (isValidMove) {
                this.clearInfo(); // Clear info before moving the unit
                this.hideEndTurnButton();
                await this.animateUnitMove(this.selectedUnit, x, y);
                this.state = 'ACTION_SELECT';
                this.showActionMenu();
                return; // Click handled as a move
            }
        } else if (this.state === 'TARGET_SELECT') {
            const targets = this.getAttackTargets(this.selectedUnit);
            const target = targets.find(t => t.x === x && t.y === y);
            if (target) {
                this.selectedTarget = target;
                this.state = 'CONFIRM_ATTACK';
                document.getElementById('targeting-ui').style.display = 'none';
                document.getElementById('confirm-attack-ui').style.display = 'flex';
                this.clearInfo(); // Clear previous info, new target is highlighted
                return; // Click handled as target selection
            }
        } else if (this.state === 'CONFIRM_ATTACK') {
            const targets = this.getAttackTargets(this.selectedUnit);
            const target = targets.find(t => t.x === x && t.y === y);
            if (target) {
                this.selectedTarget = target;
                // No state change, just target update. Still need to redraw.
                this.draw(); 
                return; // Click handled as target change
            }
        } else if (this.state === 'REACT_SELECT') {
            const targets = this.getReactTargets(this.selectedUnit);
            const target = targets.find(t => t.x === x && t.y === y);
            if (target) {
                this.selectedTarget = target;
                this.state = 'CONFIRM_REACT';
                document.getElementById('react-ui').style.display = 'none';
                document.getElementById('confirm-react-ui').style.display = 'flex';
                this.clearInfo(); // Clear previous info, new target is highlighted
                return; // Click handled as react selection
            }
        } else if (this.state === 'CONFIRM_REACT') {
            const targets = this.getReactTargets(this.selectedUnit);
            const target = targets.find(t => t.x === x && t.y === y);
            if (target) {
                this.selectedTarget = target;
                this.draw();
                return;
            }
        } else if (this.state === 'DROP_SELECT') {
            const dropPos = this.dropRange.find(p => p.x === x && p.y === y);
            if (dropPos) {
                this.executeDrop(dropPos.x, dropPos.y);
                return; // Click handled as drop
            }
        }

        // --- Êñ∞„Åó„ÅÑ„ÉÅ„Çß„ÉÉ„ÇØ: „Çø„Éº„Ç≤„ÉÉ„ÉàÈÅ∏Êäû/Á¢∫Ë™ç/Èôç‰∏ã„Çπ„ÉÜ„Éº„Éà‰∏≠„Åß„ÄÅ
        //               „Åã„Å§„ÇØ„É™„ÉÉ„ÇØ„Åå Step 1 „ÅßÂá¶ÁêÜ„Åï„Çå„Å™„Åã„Å£„ÅüÂ†¥Âêà„ÅØ„ÄÅ‰∏ÄËà¨ÁöÑ„Å™ÊÉÖÂ†±/ÁîüÁî£„ÇíÁÑ°Ë¶ñ„Åô„Çã„ÄÇ
        const isCurrentlyTargeting = ['TARGET_SELECT', 'CONFIRM_ATTACK', 'REACT_SELECT', 'CONFIRM_REACT', 'DROP_SELECT'].includes(this.state);
        if (isCurrentlyTargeting) {
            // „ÇØ„É™„ÉÉ„ÇØ„ÅåÊúâÂäπ„Å™„Çø„Éº„Ç≤„ÉÉ„Éà/Èôç‰∏ã„Åß„ÅØ„Å™„Åã„Å£„ÅüÂ†¥Âêà„ÄÅ„Åã„Å§„Çø„Éº„Ç≤„ÉÉ„ÉàÈÅ∏Êäû„Çπ„ÉÜ„Éº„Éà‰∏≠„ÅÆÂ†¥Âêà„ÅØ„ÄÅ
            // „É¶„Éã„ÉÉ„ÉàÊÉÖÂ†±„ÅÆË°®Á§∫„ÇÑÁîüÁî£„ÅÆÈñãÂßã„Å™„Å©„ÄÅ‰ªñ„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„ÅØÂÆüË°å„Åó„Å™„ÅÑ„ÄÇ
            // Êó¢Â≠ò„ÅÆÊÉÖÂ†±Ë°®Á§∫„Çí„ÇØ„É™„Ç¢„Åó„ÄÅÂÜçÊèèÁîª„Åó„Å¶„Éè„Ç§„É©„Ç§„Éà„ÇíÊõ¥Êñ∞„Åô„Çã„Å†„Åë„Å´„Åô„Çã„ÄÇ
            this.clearInfo(); // Êó¢Â≠ò„ÅÆÊÉÖÂ†±Ë°®Á§∫„Çí„ÇØ„É™„Ç¢
            this.draw(); // „Éè„Ç§„É©„Ç§„Éà„ÇíÊõ¥Êñ∞„Åô„Çã„Åü„ÇÅ„Å´ÂÜçÊèèÁîª
            return; // „ÇØ„É™„ÉÉ„ÇØ„ÅØ„ÄÅÁèæÂú®„ÅÆÊìç‰Ωú„ÅÆÊúâÂäπ„Å™„Çø„Éº„Ç≤„ÉÉ„Éà/Èôç‰∏ãÈÅ∏Êäû„Åß„ÅØ„Å™„Åã„Å£„Åü„Åü„ÇÅ„ÄÅÁÑ°Ë¶ñ„Åô„Çã„ÄÇ
        }

        // --- ÂÖÉ„ÅÆ Step 2: ÈÄ≤Ë°å‰∏≠„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„ÅåÂá¶ÁêÜ„Åï„Çå„Å™„Åã„Å£„Åü„ÄÅ„Åã„Å§„Çø„Éº„Ç≤„ÉÉ„ÉàÈÅ∏Êäû„Çπ„ÉÜ„Éº„Éà‰∏≠„Åß„Å™„ÅÑÂ†¥Âêà„ÄÅ
        //                      „Éó„É¨„Ç§„É§„Éº„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„Çπ„ÉÜ„Éº„Éà„Çí„É™„Çª„ÉÉ„Éà„Åó„ÄÅÊñ∞„Åó„ÅÑÊÉÖÂ†±/ÈÅ∏Êäû„ÇíË°®Á§∫ ---
        this.cleanupUI(); // „Çπ„ÉÜ„Éº„Éà„Çí IDLE „Å´„É™„Çª„ÉÉ„Éà„Åó„ÄÅselectedUnit „Çí„ÇØ„É™„Ç¢„Åó„ÄÅ„Ç¢„ÇØ„Ç∑„Éß„É≥„É°„Éã„É•„Éº„ÇíÈùûË°®Á§∫„Å´„Åô„Çã
        this.clearInfo(); // ‰ª•Ââç„Å´Ë°®Á§∫„Åï„Çå„Å¶„ÅÑ„ÅüÊÉÖÂ†±Ôºà„Ç´„Éº„Ç¥„ÄÅCPUÁßªÂãïÁØÑÂõ≤Ôºâ„Çí„ÇØ„É™„Ç¢„Åô„Çã

        const clickedUnit = this.units.find(u => u.x === x && u.y === y);
        const clickedBuilding = this.buildings.find(b => b.x === x && b.y === y);


        if (clickedUnit) {
            this.showInfoForUnit(clickedUnit); // This will display cargo info and/or CPU move range

            if (this.turn === 0 && clickedUnit.owner === 0 && !clickedUnit.finished) {
                // Select player's own unit for action if it's their turn and unit hasn't acted
                this.selectedUnit = clickedUnit;
                this.tempUnitState = {x: clickedUnit.x, y: clickedUnit.y}; 
                this.calcMoveRange(clickedUnit);
                this.state = 'MOVE_SELECT';
                this.showEndTurnButtonWithDelay(); // Keep end turn button if player unit is selected
            } else if (this.turn === 0 && clickedUnit.owner === 0 && clickedUnit.finished) {
                // If player unit already finished, just show info.
                // No action possible.
                this.state = 'IDLE'; // Ensure state is IDLE, cleanupUI already does this. // Hide end turn as no unit is selected for action.
            }
            // If it's a CPU unit (owner === 1), info is shown, but no action is taken by player.
            // State remains IDLE.
        } else if (clickedBuilding && this.turn === 0 && clickedBuilding.owner === 0) {
            // Clicked on player's own building, open production menu
            this.openProductionMenu(clickedBuilding);
        } else {
            // Clicked on empty tile or enemy building/unit. No action, just clear info.
            this.state = 'IDLE'; // Ensure state is IDLE
            this.showEndTurnButtonWithDelay();
        }
    }

    isValidPosition(unit, x, y) {
        if (x < 0 || x >= COLS || y < 0 || y >= ROWS) return false;
        const terrain = this.map[y][x];
        const stats = UNITS[unit.type];
        
        // Ëº∏ÈÄÅËàπ: SEA, PORT, SHOAL
        if (unit.type === UNIT_TYPES.LANDER) {
            if (terrain !== TERRAIN.SEA && terrain !== TERRAIN.PORT && terrain !== TERRAIN.SHOAL) return false;
        }
        else if (stats.moveType === MOVETYPE.SEA) {
            // Êà¶Ëâ¶Á≠â: SEA, PORT, SHOAL
            if (terrain !== TERRAIN.SEA && terrain !== TERRAIN.PORT && terrain !== TERRAIN.SHOAL) return false;
        } 
        else if (stats.moveType === MOVETYPE.LAND || stats.moveType === MOVETYPE.FOOT) {
            if (terrain === TERRAIN.SEA) return false;
            if (stats.moveType === MOVETYPE.LAND && terrain === TERRAIN.MOUNTAIN) return false;
        }
        
        const overlap = this.units.find(u => u.x === x && u.y === y && u !== unit);
        if (overlap) return false;

        return true;
    }

    canPass(unit, x, y) {
        if (x < 0 || x >= COLS || y < 0 || y >= ROWS) return false;
        const terrain = this.map[y][x];
        const stats = UNITS[unit.type];
        
        if (unit.type === UNIT_TYPES.LANDER) {
            if (terrain !== TERRAIN.SEA && terrain !== TERRAIN.PORT && terrain !== TERRAIN.SHOAL) return false;
        }
        else if (stats.moveType === MOVETYPE.SEA) {
            if (terrain !== TERRAIN.SEA && terrain !== TERRAIN.PORT && terrain !== TERRAIN.SHOAL) return false;
        } 
        else if (stats.moveType === MOVETYPE.LAND || stats.moveType === MOVETYPE.FOOT) {
            if (terrain === TERRAIN.SEA) return false;
            if (stats.moveType === MOVETYPE.LAND && terrain === TERRAIN.MOUNTAIN) return false;
        }
        
        const enemy = this.units.find(u => u.x === x && u.y === y && u.owner !== unit.owner);
        if (enemy) return false;

        return true;
    }

    canBoard(unit, transporter) {
        if (!transporter || transporter.cargo) return false;
        const tStats = UNITS[transporter.type];
        if (!tStats || !tStats.capacityType) return false; 
        if (!tStats.capacityType.includes(UNITS[unit.type].moveType)) return false;

        const tType = this.map[transporter.y][transporter.x]; // Transporter's terrain
        const unitStats = UNITS[unit.type];

        // New restriction: Prevent boarding on Forest or Mountain terrain
        if (tType === TERRAIN.FOREST || tType === TERRAIN.MOUNTAIN) {
            return false;
        }

        // ÂÖµÂ£´(Ê≠©ÂÖµ)„É¶„Éã„ÉÉ„Éà„ÅØ„ÄÅÊ∞¥Âú∞ÂΩ¢(Êµ∑„ÄÅÂ∑ù„ÄÅÊ±†)„ÅÆ‰∏ä„ÅÆËº∏ÈÄÅ„É¶„Éã„ÉÉ„Éà„Å´„ÅØÊê≠‰πó„Åß„Åç„Å™„ÅÑ
        if (unitStats.moveType === MOVETYPE.FOOT && (tType === TERRAIN.SEA || tType === TERRAIN.RIVER || tType === TERRAIN.POND)) {
            return false;
        }
        
        // Ëº∏ÈÄÅËàπ„ÅØÊ∏Ø„ÅãÊµÖÁÄ¨„Åß„ÅÆ„ÅøÊê≠‰πóÂèØËÉΩ
        if (transporter.type === UNIT_TYPES.LANDER) {
            return tType === TERRAIN.PORT || tType === TERRAIN.SHOAL;
        }
        
        // APC„Å®„Éò„É™„ÅØ„ÄÅ‰∏äË®ò„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„ÇíÈÄöÈÅé„Åô„Çå„Å∞Âü∫Êú¨ÁöÑ„Å´Êê≠‰πóÂèØËÉΩ
        return true;
    }

    getReactTargets(unit) {
        // Adjacent, Same Owner, Land Unit, Finished, Not Supply Truck
        const targets = [];
        [[0,1],[0,-1],[1,0],[-1,0]].forEach(([dx, dy]) => {
            const nx = unit.x + dx;
            const ny = unit.y + dy;
            const t = this.units.find(u => u.x === nx && u.y === ny);
            if (t && t.owner === unit.owner && t.finished && t !== unit && t.type !== UNIT_TYPES.SUPPLY) {
                const tStats = UNITS[t.type];
                if (tStats.moveType === MOVETYPE.LAND || tStats.moveType === MOVETYPE.FOOT) {
                    targets.push(t);
                }
            }
        });
        return targets;
    }

    showActionMenu() {
        const menu = document.getElementById('action-menu');
        const btnAttack = document.getElementById('act-attack');
        const btnCapture = document.getElementById('act-capture');
        const btnBoard = document.getElementById('act-board');
        const btnDrop = document.getElementById('act-drop');
        const btnReact = document.getElementById('act-react');
        const btnWait = document.getElementById('act-wait');
        
        // ÁèæÂú®Âú∞„ÅåÊúâÂäπ„Åã„ÉÅ„Çß„ÉÉ„ÇØ
        const canStand = this.isValidPosition(this.selectedUnit, this.selectedUnit.x, this.selectedUnit.y);
        
        if (canStand) {
            btnWait.classList.remove('disabled');
            btnWait.onclick = () => this.uiActionWait();
        } else {
            btnWait.classList.add('disabled');
        }

        const targets = this.getAttackTargets(this.selectedUnit);
        // Ëá™Ëµ∞Á†≤ÁßªÂãïÂæåÊîªÊíÉ‰∏çÂèØ„ÉÅ„Çß„ÉÉ„ÇØ
        const moved = (this.selectedUnit.x !== this.tempUnitState.x || this.selectedUnit.y !== this.tempUnitState.y);
        const isArtillery = (this.selectedUnit.type === UNIT_TYPES.ARTILLERY);

        if (targets.length > 0 && this.selectedUnit.ammo > 0 && canStand) {
            if (isArtillery && moved) {
                btnAttack.classList.add('disabled');
            } else {
                btnAttack.classList.remove('disabled');
                btnAttack.onclick = () => this.uiActionAttack();
            }
        } else {
            btnAttack.classList.add('disabled');
        }

        const b = this.buildings.find(bu => bu.x === this.selectedUnit.x && bu.y === this.selectedUnit.y);
        if (this.selectedUnit.type === UNIT_TYPES.INFANTRY && b && b.owner !== 0 && canStand) {
            btnCapture.classList.remove('disabled');
            btnCapture.onclick = () => this.uiActionCapture();
        } else {
            btnCapture.classList.add('disabled');
        }

        const transporter = this.units.find(u => 
            u.x === this.selectedUnit.x && u.y === this.selectedUnit.y && 
            u !== this.selectedUnit && u.owner === this.selectedUnit.owner
        );
        
        if (transporter && this.canBoard(this.selectedUnit, transporter)) {
            btnBoard.classList.remove('disabled');
            btnBoard.onclick = () => this.uiActionBoard(transporter);
            btnWait.classList.add('disabled');
        } else {
            btnBoard.classList.add('disabled');
        }

        if (this.selectedUnit.cargo && canStand) {
            this.calcDropRange(this.selectedUnit);
            if (this.dropRange.length > 0) {
                btnDrop.classList.remove('disabled');
                btnDrop.onclick = () => this.uiActionDrop();
            } else {
                btnDrop.classList.add('disabled');
            }
        } else {
            btnDrop.classList.add('disabled');
        }

        // Re-act
        const reactTargets = this.getReactTargets(this.selectedUnit);
        if (this.selectedUnit.type === UNIT_TYPES.SUPPLY && this.selectedUnit.ammo > 0 && reactTargets.length > 0 && canStand) {
            btnReact.classList.remove('disabled');
            btnReact.onclick = () => this.uiActionReact();
        } else {
            btnReact.classList.add('disabled');
        }

        menu.style.display = 'flex';
    }

    uiActionWait() { this.completeAction(); }
    uiActionCapture() {
        const b = this.buildings.find(bu => bu.x === this.selectedUnit.x && bu.y === this.selectedUnit.y);
        if (b) this.captureBuilding(b, this.selectedUnit);
        this.completeAction();
    }
    uiActionAttack() {
        this.state = 'TARGET_SELECT';
        document.getElementById('action-menu').style.display = 'none';
        document.getElementById('targeting-ui').style.display = 'flex';
        this.showToast("ÂØæË±°„Çí„Çø„ÉÉ„Éó„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
    }
    uiActionBoard(transporter) {
        transporter.cargo = this.selectedUnit;
        this.units = this.units.filter(u => u !== this.selectedUnit);
        this.selectedUnit = null;
        this.showToast("Êê≠‰πó„Åó„Åæ„Åó„Åü");
        this.completeAction();
    }
    uiActionDrop() {
        this.state = 'DROP_SELECT';
        document.getElementById('action-menu').style.display = 'none';
        document.getElementById('drop-ui').style.display = 'flex';
        this.showToast("Èôç„Çç„ÅôÂ†¥ÊâÄ„Çí„Çø„ÉÉ„Éó„Åó„Å¶„Åè„Å†„Åï„ÅÑ");
    }
    executeDrop(x, y) {
        const cargo = this.selectedUnit.cargo;
        this.selectedUnit.cargo = null;
        cargo.x = x;
        cargo.y = y;
        cargo.finished = true;
        this.units.push(cargo);
        this.completeAction();
        this.showToast("ÈôçËªä„Åó„Åæ„Åó„Åü");
    }
    uiActionReact() {
        this.state = 'REACT_SELECT';
        document.getElementById('action-menu').style.display = 'none';
        document.getElementById('react-ui').style.display = 'flex';
        this.showToast("ÂÜçË°åÂãï„Åï„Åõ„ÇãÂë≥Êñπ„ÇíÈÅ∏Êäû");
    }

    uiReturnToActionMenu() {
        this.state = 'ACTION_SELECT';
        document.getElementById('targeting-ui').style.display = 'none';
        document.getElementById('drop-ui').style.display = 'none';
        document.getElementById('react-ui').style.display = 'none';
        this.selectedTarget = null;
        this.showActionMenu();
    }
    uiReturnToTargeting() {
        this.state = 'TARGET_SELECT';
        document.getElementById('confirm-attack-ui').style.display = 'none';
        document.getElementById('targeting-ui').style.display = 'flex';
        this.selectedTarget = null;
    }
    uiReturnToReact() {
        this.state = 'REACT_SELECT';
        document.getElementById('confirm-react-ui').style.display = 'none';
        document.getElementById('react-ui').style.display = 'flex';
        this.selectedTarget = null;
    }

    uiConfirmAttack() {
        if (this.selectedUnit && this.selectedTarget) {
            this.attackUnit(this.selectedUnit, this.selectedTarget);
            this.completeAction();
        }
    }
    uiConfirmReact() {
        if (this.selectedUnit && this.selectedTarget) {
            this.selectedTarget.finished = false;
            this.selectedUnit.ammo--;
            this.showToast("ÂÜçË°åÂãïÔºÅ");
            this.completeAction();
        }
    }

    uiActionCancel() {
        if (this.selectedUnit && this.tempUnitState) {
             // Re-animate the unit back to its original position
            this.animateUnitMove(this.selectedUnit, this.tempUnitState.x, this.tempUnitState.y).then(() => {
                this.cleanupUI();
            });
        } else {
            this.cleanupUI();
        }
    }

    cleanupUI() {
        this.selectedUnit = null;
        this.selectedTarget = null;
        this.state = 'IDLE';
        this.tempUnitState = null;
        document.getElementById('action-menu').style.display = 'none';
        document.getElementById('confirm-attack-ui').style.display = 'none';
        document.getElementById('targeting-ui').style.display = 'none';
        document.getElementById('drop-ui').style.display = 'none';
        document.getElementById('react-ui').style.display = 'none';
        document.getElementById('confirm-react-ui').style.display = 'none';
        this.clearInfo(); // Clear any info display on UI cleanup
        this.showEndTurnButtonWithDelay();
    }

    completeAction() {
        if (this.selectedUnit) {
            this.selectedUnit.finished = true;
        }
        this.cleanupUI();
        this.checkWinCondition();
    }

    calcMoveRange(unit) {
        this.moveRange = [];
        const stats = UNITS[unit.type];
        let costs = {};
        let queue = [{x: unit.x, y: unit.y, cost: 0}];
        costs[`${unit.x},${unit.y}`] = 0;
        
        // ÁèæÂú®Âú∞„ÅØÂ∏∏„Å´ÁßªÂãïÂÄôË£ú„Å´Âê´„ÇÅ„Çã (ÂæÖÊ©ü„ÅÆ„Åü„ÇÅ)
        this.moveRange.push({x: unit.x, y: unit.y}); 

        while (queue.length > 0) {
            queue.sort((a,b) => a.cost - b.cost);
            const curr = queue.shift();
            if (curr.cost >= stats.move) continue;

            [[0,1],[0,-1],[1,0],[-1,0]].forEach(([dx, dy]) => {
                const nx = curr.x + dx, ny = curr.y + dy;
                if (nx>=0 && nx<COLS && ny>=0 && ny<ROWS) {
                    let mCost = TERRAIN_PROPS[this.map[ny][nx]].cost;
                    const tType = this.map[ny][nx];

                    // ÂÖµÂ£´„ÅØÊ£Æ„Çí„Ç≥„Çπ„Éà1„ÅßÁßªÂãï
                    if (unit.type === UNIT_TYPES.INFANTRY && tType === TERRAIN.FOREST) {
                        mCost = 1;
                    }
                    
                    // ÁßªÂãï„Ç≥„Çπ„ÉàË®àÁÆó (‰æµÂÖ•‰∏çÂèØÂà§ÂÆö)
                    if (unit.type === UNIT_TYPES.LANDER) {
                        if (tType !== TERRAIN.SEA && tType !== TERRAIN.PORT && tType !== TERRAIN.SHOAL) mCost = 999;
                    } else if (stats.moveType === MOVETYPE.SEA) {
                         if (tType !== TERRAIN.SEA && tType !== TERRAIN.PORT && tType !== TERRAIN.SHOAL) mCost = 999;
                    }
                    if ((stats.moveType === MOVETYPE.LAND || stats.moveType === MOVETYPE.FOOT) && tType === TERRAIN.SEA) mCost = 999;
                    if (stats.moveType === MOVETYPE.LAND && tType === TERRAIN.MOUNTAIN) mCost = 999;
                    if (stats.moveType === MOVETYPE.FOOT && tType === TERRAIN.MOUNTAIN) mCost = 2;
                    
                    if (tType === TERRAIN.RIVER) {
                        if (stats.moveType === MOVETYPE.FOOT) mCost = 2;
                        else if (stats.moveType === MOVETYPE.SEA) mCost = 999;
                    }
                    if (tType === TERRAIN.POND) {
                        if (stats.moveType === MOVETYPE.FOOT) mCost = 2;
                        else if (stats.moveType === MOVETYPE.SEA) mCost = 999;
                    }

                    if (stats.moveType === MOVETYPE.AIR) mCost = 1;

                    if (!this.canPass(unit, nx, ny)) mCost = 999;

                    const friend = this.units.find(u => u.x === nx && u.y === ny && u.owner === unit.owner);
                    if (friend) {
                         if (this.canBoard(unit, friend)) mCost = 1;
                    }

                    const newCost = curr.cost + mCost;
                    if (newCost <= stats.move) {
                        const key = `${nx},${ny}`;
                        if (costs[key] === undefined || newCost < costs[key]) {
                            costs[key] = newCost;
                            
                            let canStay = this.isValidPosition(unit, nx, ny);
                            if (friend && friend !== unit && this.canBoard(unit, friend)) canStay = true;
                            
                            if (canStay) {
                                if (!this.moveRange.some(p => p.x === nx && p.y === ny)) {
                                    this.moveRange.push({x: nx, y: ny});
                                }
                            }
                            // Queue for further exploration if path is valid (even if we can't stay)
                            if (mCost < 999) {
                                queue.push({x: nx, y: ny, cost: newCost});
                            }
                        }
                    }
                }
            });
        }
        this.moveRange = Array.from(new Set(this.moveRange.map(JSON.stringify))).map(JSON.parse);
    }

    calcDropRange(unit) {
        this.dropRange = [];
        const cargoStats = UNITS[unit.cargo.type];
        [[0,1],[0,-1],[1,0],[-1,0]].forEach(([dx, dy]) => {
            const nx = unit.x + dx;
            const ny = unit.y + dy;
            if (nx>=0 && nx<COLS && ny>=0 && ny<ROWS) {
                const tType = this.map[ny][nx];
                let validTerrain = true;
                
                // Ëº∏ÈÄÅËàπ„ÅØÊ∏Ø„ÅãÈÅìË∑Ø„Åß„ÅÆ„ÅøÈôç„Çç„Åõ„Çã
                if (unit.type === UNIT_TYPES.LANDER) {
                    const currentT = this.map[unit.y][unit.x];
                    if (currentT !== TERRAIN.PORT && currentT !== TERRAIN.SHOAL) {
                        validTerrain = false; // Èôç„Çç„ÅôÂ†¥ÊâÄ„ÅÆÊù°‰ª∂„Åß„ÅØ„Å™„Åè„ÄÅÈôç„Çç„ÅôË°åÁÇ∫Ëá™‰Ωì„ÅÆÂà∂Èôê
                    }
                }

                if (validTerrain) {
                    if ((cargoStats.moveType === MOVETYPE.LAND || cargoStats.moveType === MOVETYPE.FOOT) && tType === TERRAIN.SEA) validTerrain = false;
                    if (cargoStats.moveType === MOVETYPE.LAND && tType === TERRAIN.MOUNTAIN) validTerrain = false;
                }

                const other = this.units.find(u => u.x === nx && u.y === ny);
                if (!other && validTerrain) {
                    this.dropRange.push({x: nx, y: ny});
                }
            }
        });
    }

    getAttackTargets(unit) {
        const stats = UNITS[unit.type];
        return this.units.filter(t => {
            if (t.owner === unit.owner) return false;
            const dist = Math.abs(t.x - unit.x) + Math.abs(t.y - unit.y);
            if (dist < stats.range[0] || dist > stats.range[1]) return false;
            if (this.getBaseDamage(unit.type, t.type) === 0) return false;
            return true;
        });
    }

    getBaseDamage(atkType, defType) {
        if (DMG[atkType] && DMG[atkType][defType] !== undefined) return DMG[atkType][defType];
        return 10;
    }

    calcDamage(atk, def) {
        const baseDmg = this.getBaseDamage(atk.type, def.type);
        let power = baseDmg * (atk.hp / 100);
        if (UNITS[def.type].moveType !== MOVETYPE.AIR) {
            const terrain = this.map[def.y][def.x];
            const defVal = TERRAIN_PROPS[terrain].defense; 
            power *= (1.0 - (defVal * 0.1));
        }
        power *= (0.95 + Math.random() * 0.1);
        return Math.floor(power);
    }

    attackUnit(atk, def) {
        const dmg = this.calcDamage(atk, def);
        def.hp = Math.max(0, def.hp - dmg);
        atk.ammo = Math.max(0, atk.ammo - 1);
        
        this.addDamageEffect(def.x, def.y, dmg);
        
        if (dmg > 0) {
            const dist = Math.abs(atk.x - def.x) + Math.abs(atk.y - def.y);
            if (def.hp > 0 && dist <= 1 && def.ammo > 0) {
                const defStats = UNITS[def.type];
                if (dist >= defStats.range[0] && dist <= defStats.range[1] && this.getBaseDamage(def.type, atk.type) > 0) {
                    const cDmg = this.calcDamage(def, atk);
                    atk.hp = Math.max(0, atk.hp - cDmg);
                    def.ammo = Math.max(0, def.ammo - 1);
                    this.addDamageEffect(atk.x, atk.y, cDmg);
                }
            }
        }
        this.units = this.units.filter(u => u.hp > 0);
    }

    captureBuilding(b, u) {
        const power = Math.ceil(u.hp / 10);
        b.capture -= power;
        this.showToast(`Âç†È†ò‰∏≠... ÊÆã„Çä${Math.max(0, b.capture)}`);
        if (b.capture <= 0) {
            b.owner = u.owner;
            this.updateUI();
            b.capture = 20;
            this.showToast("Âç†È†òÂÆå‰∫ÜÔºÅ");
        }
    }

    openProductionMenu(b) {
        if (!b.producible) {
             this.showToast("„Åì„Åì„Åß„ÅØÁîüÁî£„Åß„Åç„Åæ„Åõ„Çì");
             return;
        }
        
        const menu = document.getElementById('production-menu');
        const list = document.getElementById('unit-list');
        list.innerHTML = '';
        
        let types = [];
        if ([TERRAIN.CITY, TERRAIN.HQ].includes(b.type)) types = [UNIT_TYPES.INFANTRY, UNIT_TYPES.APC, UNIT_TYPES.TANK, UNIT_TYPES.ARTILLERY, UNIT_TYPES.ANTIAIR, UNIT_TYPES.SUPPLY];
        if (b.type === TERRAIN.AIRPORT) types = [UNIT_TYPES.HELI, UNIT_TYPES.FIGHTER, UNIT_TYPES.BOMBER];
        if (b.type === TERRAIN.PORT) types = [UNIT_TYPES.SHIP, UNIT_TYPES.LANDER];

        if (types.length === 0) {
            this.showToast("„Åì„Åì„Åß„ÅØÁîüÁî£„Åß„Åç„Åæ„Åõ„Çì");
            return;
        }

        types.forEach(t => {
            const u = UNITS[t];
            const btn = document.createElement('div');
            btn.className = 'unit-prod-btn';
            const canBuy = this.funds[0] >= u.cost;
            btn.style.opacity = canBuy ? 1.0 : 0.5;
            btn.innerHTML = `<b>${u.name}</b><span>¬•${u.cost}</span><span class="unit-desc">${u.desc}</span>`;
            btn.onclick = () => {
                if (canBuy) {
                    this.funds[0] -= u.cost;
                    const newU = {type: t, owner: 0, x: b.x, y: b.y, hp: 100, finished: true};
                    newU.ammo = UNITS[t].maxAmmo;
                    this.units.push(newU);
                    closeProduction();
                    this.updateUI();
                } else {
                    this.showToast("Ë≥áÈáë„ÅåË∂≥„Çä„Åæ„Åõ„Çì");
                }
            };
            list.appendChild(btn);
        });
        document.getElementById('prod-bg').style.display = 'block';
        menu.style.display = 'block';
    }

    endTurn() {
        this.turn = (this.turn + 1) % 2;
        if (this.turn === 0) { // New round starts with player's turn
            this.turnCount++;
        }
        
        if (this.turn === 1) {
            // Sort units so Supply Truck moves last
            this.units.sort((a, b) => {
                if (a.type === UNIT_TYPES.SUPPLY && b.type !== UNIT_TYPES.SUPPLY) return 1;
                if (a.type !== UNIT_TYPES.SUPPLY && b.type === UNIT_TYPES.SUPPLY) return -1;
                return 0;
            });

            const blueCount = this.units.filter(u => u.owner === 0).length;
            const redCount = this.units.filter(u => u.owner === 1).length;
            
            this.aiStrategy.mode = 'NORMAL';
            if (redCount >= blueCount - 1 && Math.random() > 0.3) this.aiStrategy.mode = 'SAVING'; 
            if (redCount < 3) this.aiStrategy.mode = 'RUSH'; 

            const r = Math.random();
            if (r < 0.5) this.aiStrategy.focus = 'LAND';
            else if (r < 0.8) this.aiStrategy.focus = 'AIR';
            else this.aiStrategy.focus = 'SEA';
        }

        this.units.forEach(u => {
            if (u.owner === this.turn) {
                u.finished = false;
                const b = this.buildings.find(build => build.x === u.x && build.y === u.y);
                if (b && b.owner === u.owner) {
                    const uStats = UNITS[u.type];
                    let canResupply = false;
                    if ((uStats.moveType === MOVETYPE.LAND || uStats.moveType === MOVETYPE.FOOT) && (b.type === TERRAIN.CITY || b.type === TERRAIN.HQ)) canResupply = true;
                    if (uStats.moveType === MOVETYPE.AIR && b.type === TERRAIN.AIRPORT) canResupply = true;
                    if (uStats.moveType === MOVETYPE.SEA && b.type === TERRAIN.PORT) canResupply = true;

                    if (canResupply) {
                        u.ammo = uStats.maxAmmo;
                        if (u.hp < 100) {
                            const cost = Math.floor(uStats.cost * 0.1);
                            if(this.funds[this.turn] >= cost) {
                                this.funds[this.turn] -= cost;
                                u.hp = Math.min(100, u.hp + 20);
                            }
                        }
                    }
                }
                
                // Supply Truck Passive
                if (u.type === UNIT_TYPES.SUPPLY) {
                    [[0,1],[0,-1],[1,0],[-1,0]].forEach(([dx, dy]) => {
                        const nx = u.x + dx;
                        const ny = u.y + dy;
                        const friend = this.units.find(t => t.x === nx && t.y === ny && t.owner === u.owner);
                        if (friend && friend.type !== UNIT_TYPES.SUPPLY) { // ‰∏çÊ≠£ÂÜçË£úÁµ¶Èò≤Ê≠¢
                             const fStats = UNITS[friend.type];
                             if (fStats.moveType === MOVETYPE.LAND || fStats.moveType === MOVETYPE.FOOT) {
                                 friend.ammo = fStats.maxAmmo;
                             }
                        }
                    });
                }
            }
        });

        const income = this.buildings.filter(b => b.owner === this.turn).length * 1000;
        this.funds[this.turn] += income;

        this.updateUI();
        this.cleanupUI();
        this.clearInfo(); // Clear info display when turn ends

        if (this.turn === 1) {
            this.hideEndTurnButton();
            this.showToast("CPU„ÅÆ„Çø„Éº„É≥");
            setTimeout(() => this.cpuTurn(), 800);
        } else {
            this.showEndTurnButtonWithDelay();
            this.showToast("„ÅÇ„Å™„Åü„ÅÆ„Çø„Éº„É≥");
        }
    }

    clearInfo() {
        this.infoUnit = null;
        this.cpuMoveRange = [];
        document.getElementById('cargo-info-panel').style.display = 'none';
    }

    showInfoForUnit(unit) {
        this.infoUnit = unit;
        if (unit.cargo) {
            document.getElementById('cargo-info-panel').style.display = 'flex';
            this.drawCargoUnit(unit.cargo);
        }
        if (unit.owner === 1) { // CPU
            this.calcCpuMoveRange(unit);
        }
    }

    drawCargoUnit(cargo) {
        const ctx = this.cargoCtx;
        const TILE_SIZE = 60; // Fixed size for the info panel canvas
        ctx.clearRect(0, 0, TILE_SIZE, TILE_SIZE);

        const baseColor = '#999'; // Neutral color for info display

        ctx.fillStyle = baseColor;
        ctx.beginPath();
        ctx.arc(TILE_SIZE / 2, TILE_SIZE / 2, TILE_SIZE / 2 - 3, 0, Math.PI * 2);
        ctx.fill();
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.stroke();

        ctx.fillStyle = '#fff';
        ctx.font = `bold ${Math.floor(TILE_SIZE / 2.5)}px sans-serif`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(UNITS[cargo.type].label, TILE_SIZE / 2, TILE_SIZE / 2);

        const hpPct = cargo.hp / 100;
        ctx.fillStyle = 'red';
        ctx.fillRect(2, TILE_SIZE - 6, TILE_SIZE - 4, 4);
        ctx.fillStyle = hpPct > 0.5 ? '#0f0' : '#ff0';
        ctx.fillRect(2, TILE_SIZE - 6, (TILE_SIZE - 4) * hpPct, 4);

        // Always show cargo indicator
        ctx.fillStyle = '#a0f'; // Purple
        ctx.beginPath();
        ctx.arc(TILE_SIZE - 6, 6, TILE_SIZE * 0.1, 0, Math.PI * 2);
        ctx.fill();

        const statsEl = document.getElementById('cargo-stats');
        statsEl.innerText = `HP: ${cargo.hp}\nÂºæ: ${cargo.ammo}`;
    }

    calcCpuMoveRange(unit) {
        this.cpuMoveRange = [];
        const stats = UNITS[unit.type];
        let costs = {};
        let queue = [{x: unit.x, y: unit.y, cost: 0}];
        costs[`${unit.x},${unit.y}`] = 0;

        this.cpuMoveRange.push({x: unit.x, y: unit.y});

        while (queue.length > 0) {
            queue.sort((a,b) => a.cost - b.cost);
            const curr = queue.shift();
            if (curr.cost >= stats.move) continue;

            [[0,1],[0,-1],[1,0],[-1,0]].forEach(([dx, dy]) => {
                const nx = curr.x + dx, ny = curr.y + dy;
                if (nx>=0 && nx<COLS && ny>=0 && ny<ROWS) {
                    let mCost = TERRAIN_PROPS[this.map[ny][nx]].cost;
                    const tType = this.map[ny][nx];

                    if (unit.type === UNIT_TYPES.INFANTRY && tType === TERRAIN.FOREST) mCost = 1;
                    if (stats.moveType === MOVETYPE.SEA && (tType !== TERRAIN.SEA && tType !== TERRAIN.PORT && tType !== TERRAIN.SHOAL)) mCost = 999;
                    if ((stats.moveType === MOVETYPE.LAND || stats.moveType === MOVETYPE.FOOT) && tType === TERRAIN.SEA) mCost = 999;
                    if (stats.moveType === MOVETYPE.LAND && tType === TERRAIN.MOUNTAIN) mCost = 999;
                    if (stats.moveType === MOVETYPE.FOOT && tType === TERRAIN.MOUNTAIN) mCost = 2;
                    if (tType === TERRAIN.RIVER) {
                        if (stats.moveType === MOVETYPE.FOOT) mCost = 2; else if (stats.moveType === MOVETYPE.SEA) mCost = 999;
                    }
                    if (tType === TERRAIN.POND) {
                         if (stats.moveType === MOVETYPE.FOOT) mCost = 2; else if (stats.moveType === MOVETYPE.SEA) mCost = 999;
                    }
                    if (stats.moveType === MOVETYPE.AIR) mCost = 1;
                    
                    const newCost = curr.cost + mCost;
                    if (newCost <= stats.move) {
                        const key = `${nx},${ny}`;
                        if ((costs[key] === undefined || newCost < costs[key]) && mCost < 999) {
                            costs[key] = newCost;
                            if (!this.cpuMoveRange.some(p => p.x === nx && p.y === ny)) {
                                this.cpuMoveRange.push({x: nx, y: ny});
                            }
                            queue.push({x: nx, y: ny, cost: newCost});
                        }
                    }
                }
            });
        }
    }

    // --- CPU Logic ---
    async cpuTurn() {
        try {
            let actingUnit = true;
            while (actingUnit) {
                actingUnit = false;
                const unit = this.units.find(u => u.owner === 1 && !u.finished);
                if (!unit) break;
                actingUnit = true;

                const targetBuilding = this.findNearestBuilding(unit, [0, -1]); 
                const enemyHQ = this.buildings.find(b => b.type === TERRAIN.HQ && b.owner === 0);
                const enemies = this.units.filter(u => u.owner === 0);

                this.calcMoveRange(unit);
                let bestMove = null;
                let bestScore = -99999;
                let bestAction = 'WAIT'; 
                let bestTarget = null;

                const isInfantry = (unit.type === UNIT_TYPES.INFANTRY);
                const isTransporter = (UNITS[unit.type].capacityType !== undefined);
                const hasCargo = !!unit.cargo;
                const outOfAmmo = unit.ammo === 0;
                const isSupply = (unit.type === UNIT_TYPES.SUPPLY);

                let landerDestination = null;
                if (unit.type === UNIT_TYPES.LANDER && hasCargo) {
                    let targetPos = null;
                    if (unit.cargo.type === UNIT_TYPES.INFANTRY) {
                        const targetBuilding = this.findNearestBuilding(unit, [0, -1]);
                        if (targetBuilding) targetPos = { x: targetBuilding.x, y: targetBuilding.y };
                    } else {
                        const nearestEnemy = enemies.reduce((closest, enemy) => {
                            const dist = Math.abs(unit.x - enemy.x) + Math.abs(unit.y - enemy.y);
                            if (!closest || dist < closest.dist) return { enemy, dist };
                            return closest;
                        }, null)?.enemy;

                        if (nearestEnemy) {
                            targetPos = { x: nearestEnemy.x, y: nearestEnemy.y };
                        } else if (enemyHQ) {
                            targetPos = { x: enemyHQ.x, y: enemyHQ.y };
                        }
                    }
                    if (targetPos) {
                        landerDestination = this.findNearestPortOrShoal(targetPos.x, targetPos.y);
                    }
                }

                // Ensure current position is always available as fallback
                if (this.moveRange.length === 0) {
                     this.moveRange.push({x: unit.x, y: unit.y});
                }

                for (let m of this.moveRange) {
                    let score = 0;
                    let action = 'WAIT';
                    let target = null;
                    let evaluated = false; // „Åì„ÅÆ„Éû„Çπ„ÅåË©ï‰æ°Ê∏à„Åø„Åã„Å©„ÅÜ„Åã„ÅÆ„Éï„É©„Ç∞

                    // ÁßªÂãïÂÖà„Å´Âë≥Êñπ„Åå„ÅÑ„ÇãÂ†¥Âêà„ÅÆÂá¶ÁêÜ„ÇíÊúÄÂÑ™ÂÖà
                    const friendOnTarget = this.units.find(u => u.x === m.x && u.y === m.y && u.owner === unit.owner && u !== unit);
                    if (friendOnTarget) {
                        if (this.canBoard(unit, friendOnTarget)) {
                            score = 1500; // Êê≠‰πó„Å´Âü∫Êú¨„Çπ„Ç≥„Ç¢„Çí‰ªò‰∏é
                            action = 'BOARD';
                            evaluated = true; // „Åì„Çå„ÅßË©ï‰æ°ÂÆå‰∫Ü
                        } else {
                            continue; // Êê≠‰πó„Åß„Åç„Å™„ÅÑÂë≥Êñπ„ÅÆ‰∏ä„Å´„ÅØÁßªÂãï„Åó„Å™„ÅÑ
                        }
                    }

                    // ÈÄöÂ∏∏„ÅÆË©ï‰æ°„É≠„Ç∏„ÉÉ„ÇØ
                    if (!evaluated) {
                        if (unit.type === UNIT_TYPES.LANDER && hasCargo && landerDestination) {
                            const distToDest = Math.abs(m.x - landerDestination.x) + Math.abs(m.y - landerDestination.y);
                            score -= distToDest * 20; // ÁõÆÁöÑÂú∞„Å´Ëøë„Å•„Åè

                            // ÁõÆÁöÑÂú∞Âë®Ëæ∫„Å´Âà∞ÁùÄ„Åó„Åü„ÇâÈôç„Çç„ÅôÊ∫ñÂÇô
                            if (distToDest <= 1) { // Ëº∏ÈÄÅËàπ„ÅØÈö£Êé•„Éû„Çπ„Åã„ÇâÈôç„Çç„Åõ„Çã
                                const tempUnitForDropCheck = { ...unit, x: m.x, y: m.y };
                                this.calcDropRange(tempUnitForDropCheck);
                                if (this.dropRange.length > 0) {
                                    score += 5000;
                                    action = 'DROP_READY';
                                }
                            }
                        } else {
                            // Supply Truck Logic
                            if (isSupply) {
                                if (unit.ammo > 0) {
                                    let reactables = [];
                                    [[0,1],[0,-1],[1,0],[-1,0]].forEach(([dx, dy]) => {
                                        const nx = m.x + dx;
                                        const ny = m.y + dy;
                                        const ally = this.units.find(u => u.x === nx && u.y === ny && u.owner === 1 && u !== unit && u.finished);
                                        if (ally && ally.type !== UNIT_TYPES.SUPPLY) {
                                            const aStats = UNITS[ally.type];
                                            if (aStats.moveType === MOVETYPE.LAND || aStats.moveType === MOVETYPE.FOOT) {
                                                reactables.push(ally);
                                            }
                                        }
                                    });
                                    if (reactables.length > 0) {
                                        score += 3000;
                                        action = 'REACT';
                                        const priority = reactables.find(r => r.type === UNIT_TYPES.TANK || r.type === UNIT_TYPES.ARTILLERY);
                                        target = priority || reactables[0];
                                    }
                                }
                                
                                if (outOfAmmo) {
                                    const nearestSupply = this.findNearestSupply(unit);
                                    if (nearestSupply) {
                                        const dist = Math.abs(m.x - nearestSupply.x) + Math.abs(m.y - nearestSupply.y);
                                        score -= dist * 100;
                                    }
                                } else {
                                    const friends = this.units.filter(u => u.owner === 1 && (u.type === UNIT_TYPES.TANK || u.type === UNIT_TYPES.ARTILLERY));
                                    let minDist = 99;
                                    friends.forEach(f => {
                                        const d = Math.abs(m.x - f.x) + Math.abs(m.y - f.y);
                                        if (d < minDist) minDist = d;
                                    });
                                    score -= minDist * 10;
                                }

                            } else if (outOfAmmo) {
                                const nearestSupply = this.findNearestSupply(unit);
                                if (nearestSupply) {
                                    const dist = Math.abs(m.x - nearestSupply.x) + Math.abs(m.y - nearestSupply.y);
                                    score -= dist * 100;
                                }
                            } else {
                                const attackableTargets = enemies.filter(e => {
                                    const dist = Math.abs(e.x - m.x) + Math.abs(e.y - m.y);
                                    const range = UNITS[unit.type].range;
                                    return dist >= range[0] && dist <= range[1] && this.getBaseDamage(unit.type, e.type) > 0;
                                });

                                if (attackableTargets.length > 0) {
                                    const moved = (m.x !== unit.x || m.y !== unit.y);
                                    const isArtillery = (unit.type === UNIT_TYPES.ARTILLERY);

                                    if (!(isArtillery && moved)) { // Ëá™Ëµ∞Á†≤„ÅåÁßªÂãï„Åó„ÅüÂ†¥Âêà„ÅØÊîªÊíÉ„ÇíËÄÉÊÖÆ„Åó„Å™„ÅÑ
                                        score += 100;
                                        let maxDmg = 0;
                                        attackableTargets.forEach(t => {
                                            let dmg = this.getBaseDamage(unit.type, t.type);
                                            if (t.hp < dmg) dmg += 50; 
                                            if (dmg > maxDmg) maxDmg = dmg;
                                        });
                                        score += maxDmg;
                                        action = 'ATTACK';
                                    }
                                }

                                if (isInfantry) {
                                    if (action !== 'ATTACK') {
                                        const b = this.buildings.find(bu => bu.x === m.x && bu.y === m.y);
                                        if (b && b.owner !== 1) {
                                            score += 2000; 
                                            if (b.type === TERRAIN.HQ) score += 5000;
                                            action = 'CAPTURE';
                                        }
                                    }
                                }

                                if (isTransporter && !hasCargo) {
                                    const freeInfantry = this.units.find(u => u.owner === 1 && u.type === UNIT_TYPES.INFANTRY && !u.finished);
                                    if (freeInfantry) {
                                        const dist = Math.abs(m.x - freeInfantry.x) + Math.abs(m.y - freeInfantry.y);
                                        score -= dist * 5; 
                                    }
                                }

                                if (unit.type === UNIT_TYPES.ARTILLERY || unit.type === UNIT_TYPES.ANTIAIR) {
                                    let tooClose = false;
                                    enemies.forEach(e => {
                                        if (Math.abs(e.x - m.x) + Math.abs(e.y - m.y) <= 1) tooClose = true;
                                    });
                                    if (tooClose) score -= 500;
                                }
                                
                                                            // If nothing else, move towards a default destination
                                                            if (action === 'WAIT') {
                                                                const isCarryingInfantry = hasCargo && unit.cargo.type === UNIT_TYPES.INFANTRY;
                                                                let destination = null;
                                
                                                                // Infantry and units carrying them target capturable buildings
                                                                if (isInfantry || isCarryingInfantry) {
                                                                    destination = targetBuilding;
                                                                } else {
                                                                    // Other units target HQ if no enemies are present
                                                                    if (enemies.length === 0) {
                                                                        destination = enemyHQ;
                                                                    } else {
                                                                        // Otherwise, fall back to nearest capturable building
                                                                        destination = targetBuilding;
                                                                    }
                                                                }
                                
                                                                if (destination) {
                                                                    const dist = Math.abs(m.x - destination.x) + Math.abs(m.y - destination.y);
                                                                    score -= dist * 5;
                                                                } else if (enemyHQ) { // Final fallback to enemy HQ
                                                                    const dist = Math.abs(m.x - enemyHQ.x) + Math.abs(m.y - enemyHQ.y);
                                                                    score -= dist * 2;
                                                                }
                                                            }                            }
                        }
                    }

                    score += Math.random() * 20;

                    if (score > bestScore) {
                        bestScore = score;
                        bestMove = m;
                        bestAction = action;
                        bestTarget = target;
                    }
                }

                if (bestMove) {
                    await this.animateUnitMove(unit, bestMove.x, bestMove.y);

                    if (bestAction === 'BOARD') {
                        const transporter = this.units.find(u => u.x === unit.x && u.y === unit.y && u !== unit);
                        if (transporter) {
                            transporter.cargo = unit;
                            this.units = this.units.filter(u => u !== unit); 
                            this.draw();
                            continue; 
                        }
                    }

                    if (bestAction === 'REACT' && bestTarget) {
                        bestTarget.finished = false;
                        unit.ammo--;
                        this.draw();
                         await new Promise(r => setTimeout(r, 150));
                    }

                    if (bestAction === 'DROP_READY' || (isTransporter && hasCargo)) {
                        this.calcDropRange(unit);
                        if (this.dropRange.length > 0) {
                            const dropPos = this.dropRange[0]; 
                            this.executeDropAI(unit, dropPos.x, dropPos.y);
                            await new Promise(r => setTimeout(r, 150));
                        }
                    }

                    if (bestAction === 'CAPTURE' || (unit.type === UNIT_TYPES.INFANTRY)) {
                        const b = this.buildings.find(bu => bu.x === unit.x && bu.y === unit.y);
                        if (b && b.owner !== 1) {
                            this.captureBuilding(b, unit);
                        }
                    }

                    if (bestAction === 'ATTACK' && unit.ammo > 0) {
                        const targets = this.getAttackTargets(unit);
                        if (targets.length > 0) {
                            targets.sort((a,b) => a.hp - b.hp); 
                            this.attackUnit(unit, targets[0]);
                        }
                    }

                    this.checkWinCondition();
                    this.draw();
                    await new Promise(r => setTimeout(r, 100));
                }
                unit.finished = true;
            }

            const enemiesList = this.units.filter(u => u.owner === 0);
            const hasAirEnemies = enemiesList.some(u => [UNIT_TYPES.HELI, UNIT_TYPES.FIGHTER, UNIT_TYPES.BOMBER].includes(u.type));
            await this.cpuProduction(hasAirEnemies);
        } catch(e) {
            console.error(e);
        } finally {
            this.endTurn();
        }
    }

    findNearestBuilding(unit, owners) {
        let nearest = null;
        let minDist = 999;
        this.buildings.forEach(b => {
            if (owners.includes(b.owner)) {
                const dist = Math.abs(unit.x - b.x) + Math.abs(unit.y - b.y);
                if (dist < minDist) {
                    minDist = dist;
                    nearest = b;
                }
            }
        });
        return nearest;
    }

    findNearestPortOrShoal(targetX, targetY) {
        let nearest = null;
        let minDist = 999;
        const landingSpots = [];
        for (let y = 0; y < ROWS; y++) {
            for (let x = 0; x < COLS; x++) {
                const tType = this.map[y][x];
                if (tType === TERRAIN.PORT || tType === TERRAIN.SHOAL) {
                    const isOccupiedByEnemy = this.units.some(u => u.x === x && u.y === y && u.owner !== 1);
                    if (!isOccupiedByEnemy) {
                        landingSpots.push({x, y});
                    }
                }
            }
        }
        
        landingSpots.forEach(spot => {
            const dist = Math.abs(targetX - spot.x) + Math.abs(targetY - spot.y);
            if (dist < minDist) {
                minDist = dist;
                nearest = spot;
            }
        });
        return nearest;
    }

    findNearestSupply(unit) {
        let nearest = null;
        let minDist = 999;
        const uStats = UNITS[unit.type];
        this.buildings.forEach(b => {
            if (b.owner === unit.owner) {
                let compatible = false;
                if ((uStats.moveType === MOVETYPE.LAND || uStats.moveType === MOVETYPE.FOOT) && (b.type === TERRAIN.CITY || b.type === TERRAIN.HQ)) compatible = true;
                if (uStats.moveType === MOVETYPE.AIR && b.type === TERRAIN.AIRPORT) compatible = true;
                if (uStats.moveType === MOVETYPE.SEA && b.type === TERRAIN.PORT) compatible = true;
                
                if (compatible) {
                    const dist = Math.abs(unit.x - b.x) + Math.abs(unit.y - b.y);
                    if (dist < minDist) {
                        minDist = dist;
                        nearest = b;
                    }
                }
            }
        });
        return nearest;
    }

    executeDropAI(unit, x, y) {
        const cargo = unit.cargo;
        unit.cargo = null;
        cargo.x = x;
        cargo.y = y;
        cargo.finished = true;
        this.units.push(cargo);
    }

    async cpuProduction(hasAirEnemies) {
        let factories = this.buildings.filter(b => b.owner === 1 && b.producible && !this.units.find(u => u.x === b.x && u.y === b.y));
        
        // Shuffle the factories array to randomize production location
        for (let i = factories.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [factories[i], factories[j]] = [factories[j], factories[i]];
        }

        const supplyCount = this.units.filter(u => u.owner === 1 && u.type === UNIT_TYPES.SUPPLY).length;
        const landCount = this.units.filter(u => u.owner === 1 && (u.type === UNIT_TYPES.TANK || u.type === UNIT_TYPES.ARTILLERY || u.type === UNIT_TYPES.APC)).length;

        for (let b of factories) {
            if (this.aiStrategy.mode === 'SAVING' && this.funds[1] < 20000) continue; 

            let candidates = [];
            if ([TERRAIN.CITY, TERRAIN.HQ].includes(b.type)) {
                if (this.aiStrategy.focus === 'LAND' || Math.random() > 0.5) {
                    candidates.push(UNIT_TYPES.TANK, UNIT_TYPES.ARTILLERY, UNIT_TYPES.APC);
                    if (hasAirEnemies) candidates.push(UNIT_TYPES.ANTIAIR); 
                    
                    if (landCount >= 3 && supplyCount < 3) {
                         candidates.push(UNIT_TYPES.SUPPLY);
                    }
                }
                candidates.push(UNIT_TYPES.INFANTRY); 
            }
            if (b.type === TERRAIN.AIRPORT) {
                if (this.funds[1] > 20000) candidates.push(UNIT_TYPES.BOMBER, UNIT_TYPES.FIGHTER);
                candidates.push(UNIT_TYPES.HELI);
            }
            if (b.type === TERRAIN.PORT) {
                if (this.funds[1] > 25000) candidates.push(UNIT_TYPES.SHIP);
                candidates.push(UNIT_TYPES.LANDER);
            }

            candidates = candidates.filter(t => UNITS[t].cost <= this.funds[1]);
            
            if (candidates.length > 0) {
                candidates.sort((a,b) => UNITS[b].cost - UNITS[a].cost);
                const pickIdx = Math.floor(Math.random() * Math.ceil(candidates.length / 2));
                const type = candidates[pickIdx];

                this.funds[1] -= UNITS[type].cost;
                const newU = {type: type, owner: 1, x: b.x, y: b.y, hp: 100, finished: true};
                newU.ammo = UNITS[type].maxAmmo;
                this.units.push(newU);
                this.updateUI();
                this.draw();
                await new Promise(r => setTimeout(r, 100));
            }
        }
    }

    checkWinCondition() {
        const blueHQ = this.buildings.find(b => b.type === TERRAIN.HQ && b.owner === 0);
        const redHQ = this.buildings.find(b => b.type === TERRAIN.HQ && b.owner === 1);
        let winner = null;
        
        if (!blueHQ) winner = 'CPU (Ëµ§Ëªç)';
        if (!redHQ) winner = 'YOU (ÈùíËªç)';
        
            if (winner) {
                const messageEl = document.getElementById('message-text');
                messageEl.innerHTML = `
                    ${winner} „ÅÆÂãùÂà©ÔºÅ
                    <p style="font-size: 0.6em; margin-top: 10px;">ÁµåÈÅé„Çø„Éº„É≥: ${this.turnCount}</p>
                `;
                document.getElementById('message-overlay').style.display = 'flex';
                document.getElementById('end-turn-btn').style.display = 'none';
                this.turn = -1; 
            }    }

    updateUI() {
        const blueIncome = this.buildings.filter(b => b.owner === 0).length * 1000;
        const redIncome = this.buildings.filter(b => b.owner === 1).length * 1000;

        document.getElementById('info-panel').style.display = 'block';
        document.getElementById('info-panel').innerHTML = `
            <div style="color:#48f;font-weight:bold">ÈùíËªç: ¬•${this.funds[0]} ÂèéÂÖ•: ¬•${blueIncome}</div>
            <div style="color:#f44;font-weight:bold;">Ëµ§Ëªç: ¬•${this.funds[1]} ÂèéÂÖ•: ¬•${redIncome}</div>
            <div style="margin-top:4px;font-size:12px; color:#333;">„Çø„Éº„É≥: ${this.turnCount}</div>
            <div style="margin-top:4px;font-size:11px;">${this.turn === 0 ? '„ÅÇ„Å™„Åü„ÅÆ„Çø„Éº„É≥' : 'CPUÊÄùËÄÉ‰∏≠'}</div>
        `;
    }

    draw() {
        if (!this.map.length) return;
        this.ctx.fillStyle = '#222';
        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
        this.ctx.save();
        this.ctx.translate(this.cameraOffset.x, this.cameraOffset.y);
        
        const TILE_SIZE = this.effectiveTileSize;

        this.map.forEach((row, y) => row.forEach((t, x) => this.drawTile(x, y, t)));
        this.buildings.forEach(b => this.drawBuilding(b));
        
        if (this.cpuMoveRange.length > 0) {
            this.ctx.fillStyle = 'rgba(255, 0, 0, 0.3)'; // Semi-transparent red for CPU move range
            this.cpuMoveRange.forEach(p => this.ctx.fillRect(p.x*TILE_SIZE+2, p.y*TILE_SIZE+2, TILE_SIZE-4, TILE_SIZE-4));
        }

        if (this.state === 'MOVE_SELECT') {
            this.ctx.fillStyle = 'rgba(255,255,255,0.4)';
            this.moveRange.forEach(p => this.ctx.fillRect(p.x*TILE_SIZE+2, p.y*TILE_SIZE+2, TILE_SIZE-4, TILE_SIZE-4));
        }
        if (this.state === 'DROP_SELECT') {
            this.ctx.fillStyle = 'rgba(0,255,255,0.4)';
            this.dropRange.forEach(p => this.ctx.fillRect(p.x*TILE_SIZE+2, p.y*TILE_SIZE+2, TILE_SIZE-4, TILE_SIZE-4));
        }
        if (this.state === 'TARGET_SELECT' || this.state === 'CONFIRM_ATTACK') {
            const targets = this.getAttackTargets(this.selectedUnit);
            const time = Date.now() / 200;
            targets.forEach(t => {
                this.ctx.strokeStyle = `rgba(255, 50, 255, ${Math.abs(Math.sin(time)) + 0.5})`;
                this.ctx.lineWidth = 3;
                this.ctx.strokeRect(t.x*TILE_SIZE, t.y*TILE_SIZE, TILE_SIZE, TILE_SIZE);
            });
            if (this.selectedTarget) {
                this.ctx.strokeStyle = '#ff0000';
                this.ctx.lineWidth = 5;
                this.ctx.strokeRect(this.selectedTarget.x*TILE_SIZE, this.selectedTarget.y*TILE_SIZE, TILE_SIZE, TILE_SIZE);
            }
        }
        if (this.state === 'REACT_SELECT' || this.state === 'CONFIRM_REACT') {
             const targets = this.getReactTargets(this.selectedUnit);
             const time = Date.now() / 200;
             targets.forEach(t => {
                this.ctx.strokeStyle = `rgba(0, 255, 0, ${Math.abs(Math.sin(time)) + 0.5})`;
                this.ctx.lineWidth = 3;
                this.ctx.strokeRect(t.x*TILE_SIZE, t.y*TILE_SIZE, TILE_SIZE, TILE_SIZE);
             });
             if (this.selectedTarget) {
                 this.ctx.strokeStyle = 'red';
                 this.ctx.lineWidth = 5;
                 this.ctx.strokeRect(this.selectedTarget.x*TILE_SIZE, this.selectedTarget.y*TILE_SIZE, TILE_SIZE, TILE_SIZE);
             }
        }
        
        this.units.forEach(u => this.drawUnit(u));
        if (this.selectedUnit && !this.selectedUnit.isAnimating) {
            this.ctx.strokeStyle = 'yellow';
            this.ctx.lineWidth = 3;
            this.ctx.strokeRect(this.selectedUnit.x*TILE_SIZE, this.selectedUnit.y*TILE_SIZE, TILE_SIZE, TILE_SIZE);
        }

        this.ctx.fillStyle = '#fff';
        this.ctx.font = `bold ${Math.max(12, 20 * this.zoomLevel)}px sans-serif`;
        this.ctx.textAlign = 'center';
        this.ctx.shadowColor = 'black';
        this.ctx.shadowBlur = 4;
        this.effects.forEach(e => {
            this.ctx.fillText(e.text, e.x, e.y + e.offsetY);
        });
        this.ctx.shadowBlur = 0;

        this.ctx.restore();
    }

    drawTile(x, y, t) {
        const TILE_SIZE = this.effectiveTileSize;
        this.ctx.save();
        this.ctx.fillStyle = TERRAIN_PROPS[t] ? TERRAIN_PROPS[t].color : '#fff';
        this.ctx.fillRect(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);

        if (t === TERRAIN.FOREST) {
            this.ctx.fillStyle = '#151';
            this.ctx.beginPath();
            this.ctx.arc(x * TILE_SIZE + TILE_SIZE / 2, y * TILE_SIZE + TILE_SIZE / 2, TILE_SIZE / 3, 0, Math.PI * 2);
            this.ctx.fill();
        }
        if (t === TERRAIN.MOUNTAIN) {
            this.ctx.fillStyle = '#531';
            this.ctx.beginPath();
            this.ctx.moveTo(x * TILE_SIZE + TILE_SIZE / 2, y * TILE_SIZE + TILE_SIZE / 4);
            this.ctx.lineTo(x * TILE_SIZE + TILE_SIZE / 4, y * TILE_SIZE + TILE_SIZE * 0.75);
            this.ctx.lineTo(x * TILE_SIZE + TILE_SIZE * 0.75, y * TILE_SIZE + TILE_SIZE * 0.75);
            this.ctx.closePath();
            this.ctx.fill();
        }
        if (t === TERRAIN.RIVER) {
            this.ctx.strokeStyle = '#87ceeb'; // SkyBlue
            this.ctx.lineWidth = 2;
            const spacing = TILE_SIZE / 4;
            for (let i = 1; i <= 3; i++) {
                this.ctx.beginPath();
                this.ctx.moveTo(x * TILE_SIZE + i * spacing, y * TILE_SIZE);
                this.ctx.lineTo(x * TILE_SIZE + i * spacing, (y + 1) * TILE_SIZE);
                this.ctx.stroke();
            }
        }
        if (t === TERRAIN.POND) {
            this.ctx.fillStyle = 'white';
            this.ctx.font = `bold ${TILE_SIZE / 2.5}px sans-serif`;
            this.ctx.textAlign = 'center';
            this.ctx.textBaseline = 'middle';
            this.ctx.fillText('Ê±†', x * TILE_SIZE + TILE_SIZE / 2, y * TILE_SIZE + TILE_SIZE / 2);
        }
        this.ctx.restore();
    }

    drawBuilding(b) {
        const TILE_SIZE = this.effectiveTileSize;
        this.ctx.save();
        const c = b.owner === 0 ? '#48f' : (b.owner === 1 ? '#f44' : '#888');
        const x = b.x*TILE_SIZE, y = b.y*TILE_SIZE;
        
        // Draw outline for producible buildings
        if (b.producible) {
             this.ctx.strokeStyle = 'orange';
             this.ctx.lineWidth = 4;
             this.ctx.strokeRect(x + 2, y + 12, TILE_SIZE - 4, TILE_SIZE - 14);
             this.ctx.lineWidth = 1; // Reset
        }

        this.ctx.fillStyle = 'rgba(0,0,0,0.5)'; this.ctx.fillRect(x+6, y+16, TILE_SIZE-12, TILE_SIZE-20);
        this.ctx.fillStyle = c; this.ctx.fillRect(x+4, y+14, TILE_SIZE-8, TILE_SIZE-18);
        this.ctx.fillStyle = '#fff'; this.ctx.font = `bold ${Math.floor(TILE_SIZE/2)}px sans-serif`;
        this.ctx.textAlign = 'center';
        let s = '„Äí'; 
        if(b.type===TERRAIN.HQ) { s='‚òÖ'; this.ctx.fillStyle = '#ffed00'; }
        if(b.type===TERRAIN.AIRPORT) s='‚úà'; if(b.type===TERRAIN.PORT) s='‚öì';
        this.ctx.fillText(s, x+TILE_SIZE/2, y+TILE_SIZE-5);
        if(b.capture<20) {
            this.ctx.fillStyle='#333'; this.ctx.fillRect(x+2,y,TILE_SIZE-4,4);
            this.ctx.fillStyle='#0f0'; this.ctx.fillRect(x+2,y,(TILE_SIZE-4)*(b.capture/20),4);
        }
        this.ctx.restore();
    }

    drawUnit(u) {
        const TILE_SIZE = this.effectiveTileSize;
        let drawX, drawY;

        if (u.isAnimating) {
            const ease = (t) => t < 0.5 ? 2*t*t : -1+(4-2*t)*t; // ease in-out quad
            const progress = ease(u.animProgress);
            
            const startX = u.animStartX * TILE_SIZE;
            const startY = u.animStartY * TILE_SIZE;
            const endX = u.animEndX * TILE_SIZE;
            const endY = u.animEndY * TILE_SIZE;
            
            drawX = startX + (endX - startX) * progress;
            drawY = startY + (endY - startY) * progress;
        } else {
            drawX = u.x * TILE_SIZE;
            drawY = u.y * TILE_SIZE;
        }
        
        let baseColor;
        if (u.owner === 0) baseColor = u.finished ? '#236' : '#48f';
        else baseColor = u.finished ? '#622' : '#f44';
        
        this.ctx.fillStyle = baseColor;
        this.ctx.beginPath(); this.ctx.arc(drawX+TILE_SIZE/2, drawY+TILE_SIZE/2, TILE_SIZE/2-3, 0, Math.PI*2); this.ctx.fill();
        this.ctx.strokeStyle='#fff'; this.ctx.lineWidth=2; this.ctx.stroke();
        this.ctx.fillStyle='#fff'; this.ctx.font=`bold ${Math.floor(TILE_SIZE/2.5)}px sans-serif`;
        this.ctx.textAlign='center'; this.ctx.textBaseline='middle';
        this.ctx.fillText(UNITS[u.type].label, drawX+TILE_SIZE/2, drawY+TILE_SIZE/2);
        
        const hpPct = u.hp / 100;
        this.ctx.fillStyle = 'red';
        this.ctx.fillRect(drawX+2, drawY+TILE_SIZE-6, TILE_SIZE-4, 4);
        this.ctx.fillStyle = hpPct > 0.5 ? '#0f0' : '#ff0';
        this.ctx.fillRect(drawX+2, drawY+TILE_SIZE-6, (TILE_SIZE-4)*hpPct, 4);

        if (TILE_SIZE > 25) {
            this.ctx.fillStyle = '#80f';
            this.ctx.fillRect(drawX+1, drawY+1, 18, 14);
            this.ctx.fillStyle = '#fff';
            this.ctx.font = '13px monospace';
            this.ctx.fillText(u.ammo, drawX+10, drawY+8);
        }

        if (u.cargo) {
            this.ctx.fillStyle = '#a0f'; // Purple
            this.ctx.beginPath();
            this.ctx.arc(drawX+TILE_SIZE-6, drawY+6, Math.max(2, TILE_SIZE * 0.1), 0, Math.PI*2);
            this.ctx.fill();
        }
    }
}

let game;
window.startGame = (i) => {
    document.getElementById('menu-overlay').style.display='none';
    if(!game) game = new Game();
    game.initStage(i);
    document.getElementById('end-turn-btn').style.display='block';
};
window.closeProduction = () => {
    document.getElementById('prod-bg').style.display='none';
    document.getElementById('production-menu').style.display='none';
};
window.toggleHelp = () => {
    const m = document.getElementById('help-modal');
    const b = document.getElementById('help-bg');
    const s = m.style.display === 'block' ? 'none' : 'block';
    m.style.display = s; b.style.display = s;
};
window.confirmReset = () => {
    if (window.confirm("„Ç≤„Éº„É†„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô „Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü")) {
        resetGame();
    }
};

window.resetGame = () => location.reload();

window.toggleGameMenu = () => {
    const menu = document.getElementById('game-menu-modal');
    const bg = document.getElementById('game-menu-bg');
    const isVisible = menu.style.display === 'flex';

    if (!isVisible) {
        document.getElementById('speed-slider').value = animationSpeed;
        document.getElementById('anim-toggle-btn').innerText = `„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥: ${isAnimationEnabled ? 'ON' : 'OFF'}`;
    }
    
    menu.style.display = isVisible ? 'none' : 'flex';
    bg.style.display = isVisible ? 'none' : 'block';
};

window.setAnimationSpeed = (val) => {
    animationSpeed = parseFloat(val);
};

window.toggleAnimation = () => {
    isAnimationEnabled = !isAnimationEnabled;
    document.getElementById('anim-toggle-btn').innerText = `„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥: ${isAnimationEnabled ? 'ON' : 'OFF'}`;
};

window.showHelpFromMenu = () => {
    toggleGameMenu(); // Close game menu
    setTimeout(() => toggleHelp(), 100); // Open help menu after a short delay
};
</script>
</body>
</html>